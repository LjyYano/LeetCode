---
title: é“¾è¡¨éšæœºèŠ‚ç‚¹
date: 2024-03-27
---

## é¢˜ç›®æè¿°

**ğŸ”— é¢˜ç›®**ï¼š[é“¾è¡¨éšæœºèŠ‚ç‚¹](https://leetcode.cn/problems/linked-list-random-node/)  
**ğŸ·ï¸ æ ‡ç­¾**ï¼š`é“¾è¡¨` `æ•°å­¦` `æ°´å¡˜æŠ½æ ·` `éšæœºåŒ–`  
**ğŸŸ¡ éš¾åº¦**ï¼š`ä¸­ç­‰`  

ç»™ä½ ä¸€ä¸ªå•é“¾è¡¨ï¼Œéšæœºé€‰æ‹©é“¾è¡¨çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¹¶è¿”å›ç›¸åº”çš„èŠ‚ç‚¹å€¼ã€‚æ¯ä¸ªèŠ‚ç‚¹è¢«é€‰ä¸­çš„æ¦‚ç‡ä¸€æ ·ã€‚

å®ç° Solution ç±»ï¼š
- Solution(ListNode head) ä½¿ç”¨æ•´æ•°æ•°ç»„åˆå§‹åŒ–å¯¹è±¡ã€‚
- int getRandom() ä»é“¾è¡¨ä¸­éšæœºé€‰æ‹©ä¸€ä¸ªèŠ‚ç‚¹å¹¶è¿”å›è¯¥èŠ‚ç‚¹çš„å€¼ã€‚é“¾è¡¨ä¸­æ‰€æœ‰èŠ‚ç‚¹è¢«é€‰ä¸­çš„æ¦‚ç‡ç›¸ç­‰ã€‚

![img](https://assets.leetcode.com/uploads/2021/03/16/getrand-linked-list.jpg)

ç¤ºä¾‹ï¼š
```
è¾“å…¥
["Solution", "getRandom", "getRandom", "getRandom", "getRandom", "getRandom"]
[[[1, 2, 3]], [], [], [], [], []]
è¾“å‡º
[null, 1, 3, 2, 2, 3]

è§£é‡Š
Solution solution = new Solution([1, 2, 3]);
solution.getRandom(); // è¿”å› 1
solution.getRandom(); // è¿”å› 3
solution.getRandom(); // è¿”å› 2
solution.getRandom(); // è¿”å› 2
solution.getRandom(); // è¿”å› 3
// getRandom() æ–¹æ³•åº”éšæœºè¿”å› 1ã€2ã€3ä¸­çš„ä¸€ä¸ªï¼Œæ¯ä¸ªå…ƒç´ è¢«è¿”å›çš„æ¦‚ç‡ç›¸ç­‰ã€‚
```

æç¤ºï¼š
- é“¾è¡¨ä¸­çš„èŠ‚ç‚¹æ•°åœ¨èŒƒå›´ [1, 10â´] å†…
- -10â´ <= Node.val <= 10â´
- è‡³å¤šè°ƒç”¨ getRandom æ–¹æ³• 10â´ æ¬¡

è¿›é˜¶ï¼š
- å¦‚æœé“¾è¡¨éå¸¸å¤§ä¸”é•¿åº¦æœªçŸ¥ï¼Œè¯¥æ€ä¹ˆå¤„ç†ï¼Ÿ
- ä½ èƒ½å¦åœ¨ä¸ä½¿ç”¨é¢å¤–ç©ºé—´çš„æƒ…å†µä¸‹è§£å†³æ­¤é—®é¢˜ï¼Ÿ

---

## è§£é¢˜æ€è·¯

### è“„æ°´æ± æŠ½æ ·ç®—æ³•

#### ğŸ“ æ ¸å¿ƒæ€æƒ³
è“„æ°´æ± æŠ½æ ·ç®—æ³•æ˜¯ä¸€ä¸ªéå¸¸å·§å¦™çš„ç®—æ³•ï¼Œå®ƒå¯ä»¥åœ¨ä¸çŸ¥é“æ€»æ•°æ®é‡çš„æƒ…å†µä¸‹ï¼Œä»æ•°æ®æµä¸­éšæœºé€‰æ‹© k ä¸ªæ•°æ®ï¼Œä½¿å¾—æ¯ä¸ªæ•°æ®è¢«é€‰ä¸­çš„æ¦‚ç‡ç›¸ç­‰ã€‚åœ¨æœ¬é¢˜ä¸­ï¼Œk = 1ï¼Œå³æˆ‘ä»¬åªéœ€è¦éšæœºé€‰æ‹©ä¸€ä¸ªèŠ‚ç‚¹ã€‚

ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š
1. å¯¹äºç¬¬ i ä¸ªèŠ‚ç‚¹ï¼Œä»¥ 1/i çš„æ¦‚ç‡é€‰æ‹©å®ƒæ›¿æ¢å½“å‰çš„ç»“æœ
2. è¿™æ ·å¯ä»¥ä¿è¯æ¯ä¸ªèŠ‚ç‚¹æœ€ç»ˆè¢«é€‰ä¸­çš„æ¦‚ç‡éƒ½æ˜¯ 1/nï¼ˆn ä¸ºé“¾è¡¨é•¿åº¦ï¼‰

#### ğŸ› ï¸ å®ç°æ­¥éª¤
1. åˆå§‹åŒ–ï¼š
   - å°†ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„å€¼ä½œä¸ºå½“å‰ç»“æœ
   - ä»ç¬¬äºŒä¸ªèŠ‚ç‚¹å¼€å§‹éå†

2. å¯¹äºç¬¬ i ä¸ªèŠ‚ç‚¹ï¼ˆi ä» 2 å¼€å§‹ï¼‰ï¼š
   - ç”Ÿæˆä¸€ä¸ª [0, i) èŒƒå›´å†…çš„éšæœºæ•°
   - å¦‚æœè¿™ä¸ªéšæœºæ•°æ˜¯ 0ï¼ˆæ¦‚ç‡ä¸º 1/iï¼‰ï¼Œåˆ™ç”¨å½“å‰èŠ‚ç‚¹çš„å€¼æ›¿æ¢ç»“æœ
   - ç»§ç»­éå†ä¸‹ä¸€ä¸ªèŠ‚ç‚¹

3. éå†ç»“æŸåï¼Œè¿”å›æœ€ç»ˆçš„ç»“æœ

#### ğŸ§© ç¤ºä¾‹åˆ†æ
ä»¥é“¾è¡¨ [1, 2, 3] ä¸ºä¾‹ï¼Œåˆ†ææ¯ä¸ªèŠ‚ç‚¹è¢«é€‰ä¸­çš„æ¦‚ç‡ï¼š

| èŠ‚ç‚¹ | ä½ç½® | è¢«é€‰ä¸­å¹¶ä¿ç•™çš„æ¦‚ç‡ |
|-----|-----|-----------------|
| 1 | ç¬¬ 1 ä¸ª | åˆå§‹è¢«é€‰ä¸­ï¼Œä¿ç•™çš„æ¦‚ç‡ = 1 Ã— (1-1/2) Ã— (1-1/3) = 1/3 |
| 2 | ç¬¬ 2 ä¸ª | è¢«é€‰ä¸­çš„æ¦‚ç‡ = 1/2 Ã— (1-1/3) = 1/3 |
| 3 | ç¬¬ 3 ä¸ª | è¢«é€‰ä¸­çš„æ¦‚ç‡ = 1/3 = 1/3 |

å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ€ç»ˆè¢«é€‰ä¸­çš„æ¦‚ç‡éƒ½æ˜¯ 1/3ï¼Œå®ç°äº†å®Œå…¨éšæœºã€‚

---

## ä»£ç å®ç°

å®Œæ•´çš„å¯è¿è¡Œä»£ç ï¼š[L0382_LinkedListRandomNode.java](../src/main/java/L0382_LinkedListRandomNode.java)

```java
public class L0382_LinkedListRandomNode {
    private ListNode head;
    private Random rand;
    
    public L0382_LinkedListRandomNode(ListNode head) {
        this.head = head;
        this.rand = new Random();
    }
    
    public int getRandom() {
        int result = head.val;
        ListNode current = head.next;
        int i = 2;
        
        while (current != null) {
            if (rand.nextInt(i) == 0) {
                result = current.val;
            }
            current = current.next;
            i++;
        }
        
        return result;
    }
}
```

---

## å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼šO(n)
  - éœ€è¦éå†æ•´ä¸ªé“¾è¡¨ä¸€æ¬¡
  - æ¯ä¸ªèŠ‚ç‚¹çš„å¤„ç†æ—¶é—´æ˜¯ O(1)

- **ç©ºé—´å¤æ‚åº¦**ï¼šO(1)
  - åªä½¿ç”¨äº†å‡ ä¸ªå˜é‡æ¥å­˜å‚¨ä¸´æ—¶ç»“æœå’Œè®¡æ•°å™¨
  - ä¸éœ€è¦é¢å¤–çš„æ•°æ®ç»“æ„æ¥å­˜å‚¨é“¾è¡¨èŠ‚ç‚¹

---

## LeetCode é¢˜è§£

æœ¬é¢˜è§£æ˜¯ LeetCode ç³»åˆ—é¢˜è§£çš„ä¸€éƒ¨åˆ†ã€‚è¯¥ç³»åˆ—é¢˜è§£è‡´åŠ›äºå¸®åŠ©ç¨‹åºå‘˜æ›´å¥½åœ°ç†è§£å’ŒæŒæ¡ç®—æ³•æ€ç»´ï¼Œå†…å®¹åŒ…å«è¯¦ç»†çš„è§£é¢˜æ€è·¯åˆ†æã€å›¾æ–‡å¹¶èŒ‚çš„ç¤ºä¾‹è®²è§£å’Œå®Œæ•´çš„ä»£ç å®ç°ã€‚

<img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="GitHub" width="20" style="vertical-align: middle; margin-right: 5px"> [LeetCode æœ€å…¨é¢˜è§£](https://github.com/LjyYano/LeetCode)ï¼šæŒç»­æ›´æ–°ä¸­ï¼Œæ¬¢è¿ Star â­ï¸ å…³æ³¨ï¼Œä¸€èµ·æ¢è®¨ç®—æ³•ä¹‹ç¾ã€‚ 