---
title: å­˜åœ¨é‡å¤å…ƒç´  III
date: 2025-02-10
---

## é¢˜ç›®æè¿°

**ğŸ”— é¢˜ç›®**ï¼š[å­˜åœ¨é‡å¤å…ƒç´  III](https://leetcode.cn/problems/contains-duplicate-iii/)  
**ğŸ·ï¸ æ ‡ç­¾**ï¼š`æ•°ç»„` `æ¡¶æ’åº` `æœ‰åºé›†åˆ` `æ’åº` `æ»‘åŠ¨çª—å£`  
**ğŸ”´ éš¾åº¦**ï¼š`å›°éš¾`  

ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸¤ä¸ªæ•´æ•° k å’Œ t ã€‚è¯·ä½ åˆ¤æ–­æ˜¯å¦å­˜åœ¨ ä¸¤ä¸ªä¸åŒä¸‹æ ‡ i å’Œ jï¼Œä½¿å¾— abs(nums[i] - nums[j]) <= t ï¼ŒåŒæ—¶åˆæ»¡è¶³ abs(i - j) <= k ã€‚

å¦‚æœå­˜åœ¨åˆ™è¿”å› trueï¼Œä¸å­˜åœ¨è¿”å› falseã€‚

ç¤ºä¾‹ 1ï¼š
```
è¾“å…¥ï¼šnums = [1,2,3,1], k = 3, t = 0
è¾“å‡ºï¼štrue
```

ç¤ºä¾‹ 2ï¼š
```
è¾“å…¥ï¼šnums = [1,0,1,1], k = 1, t = 2
è¾“å‡ºï¼štrue
```

ç¤ºä¾‹ 3ï¼š
```
è¾“å…¥ï¼šnums = [1,5,9,1,5,9], k = 2, t = 3
è¾“å‡ºï¼šfalse
```

æç¤ºï¼š
- 0 <= nums.length <= 2 * 10â´
- -2Â³Â¹ <= nums[i] <= 2Â³Â¹ - 1
- 0 <= k <= 10â´
- 0 <= t <= 2Â³Â¹ - 1

---

## è§£é¢˜æ€è·¯

### æ¡¶æ’åºæ³•

#### ğŸ“ æ ¸å¿ƒæ€æƒ³
æœ¬é¢˜ä½¿ç”¨æ¡¶æ’åºçš„æ€æƒ³æ¥è§£å†³ã€‚æˆ‘ä»¬å°†æ•°ç»„ä¸­çš„æ•°å­—æŒ‰ç…§å¤§å°åˆ†é…åˆ°ä¸åŒçš„æ¡¶ä¸­ï¼Œæ¯ä¸ªæ¡¶çš„å¤§å°ä¸º t + 1ã€‚è¿™æ ·ï¼Œå¦‚æœä¸¤ä¸ªæ•°å­—è¢«åˆ†é…åˆ°åŒä¸€ä¸ªæ¡¶ä¸­ï¼Œé‚£ä¹ˆå®ƒä»¬çš„å·®çš„ç»å¯¹å€¼ä¸€å®šå°äºç­‰äº tã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ£€æŸ¥ç›¸é‚»çš„æ¡¶ï¼Œå› ä¸ºå¯èƒ½æœ‰å·®å€¼å°äºç­‰äº t çš„æ•°å­—è¢«åˆ†é…åˆ°ç›¸é‚»çš„æ¡¶ä¸­ã€‚

æ¡¶çš„å¤§å°é€‰æ‹© t + 1 çš„åŸå› æ˜¯ï¼š
1. å¦‚æœä¸¤ä¸ªæ•°å­—çš„å·®å€¼å°äºç­‰äº tï¼Œé‚£ä¹ˆå®ƒä»¬è¦ä¹ˆåœ¨åŒä¸€ä¸ªæ¡¶ä¸­ï¼Œè¦ä¹ˆåœ¨ç›¸é‚»çš„æ¡¶ä¸­
2. æ¡¶çš„å¤§å°ä¸º t + 1 å¯ä»¥ä¿è¯ï¼Œå¦‚æœä¸¤ä¸ªæ•°å­—åœ¨åŒä¸€ä¸ªæ¡¶ä¸­ï¼Œå®ƒä»¬çš„å·®å€¼ä¸€å®šå°äºç­‰äº t

#### ğŸ› ï¸ å®ç°æ­¥éª¤
1. ç‰¹æ®Šæƒ…å†µå¤„ç†ï¼š
   - å¦‚æœæ•°ç»„ä¸ºç©ºï¼Œæˆ– k <= 0ï¼Œæˆ– t < 0ï¼Œè¿”å› false
   
2. åˆå§‹åŒ–ï¼š
   - åˆ›å»ºä¸€ä¸ª HashMap ä½œä¸ºæ¡¶ï¼Œkey æ˜¯æ¡¶çš„ IDï¼Œvalue æ˜¯æ¡¶ä¸­çš„æ•°å­—
   - æ¡¶çš„å¤§å°è®¾ç½®ä¸º t + 1
   
3. éå†æ•°ç»„ï¼š
   - å¯¹äºæ¯ä¸ªæ•°å­—ï¼Œè®¡ç®—å®ƒåº”è¯¥å±äºå“ªä¸ªæ¡¶
   - æ£€æŸ¥å½“å‰æ¡¶æ˜¯å¦å·²ç»æœ‰æ•°å­—
   - æ£€æŸ¥ç›¸é‚»çš„æ¡¶ä¸­æ˜¯å¦æœ‰ç¬¦åˆæ¡ä»¶çš„æ•°å­—
   - å°†å½“å‰æ•°å­—æ”¾å…¥å¯¹åº”çš„æ¡¶ä¸­
   - å¦‚æœçª—å£å¤§å°è¶…è¿‡ kï¼Œç§»é™¤æœ€æ—©çš„æ•°å­—

4. æ¡¶ ID çš„è®¡ç®—ï¼š
   - å¯¹äºéè´Ÿæ•°ï¼šnum / w
   - å¯¹äºè´Ÿæ•°ï¼š(num + 1) / w - 1
   å…¶ä¸­ w æ˜¯æ¡¶çš„å¤§å°ï¼ˆt + 1ï¼‰

#### ğŸ§© ç¤ºä¾‹åˆ†æ
ä»¥è¾“å…¥ `nums = [1,2,3,1], k = 3, t = 0` ä¸ºä¾‹ï¼š

| æ­¥éª¤ | å½“å‰æ•°å­— | æ¡¶ ID | æ¡¶çš„çŠ¶æ€ | æ£€æŸ¥ç»“æœ | è¯´æ˜ |
|-----|---------|-------|----------|----------|------|
| 1 | 1 | 1 | {1: 1} | false | ç¬¬ä¸€ä¸ªæ•°å­—ï¼Œæ”¾å…¥æ¡¶ 1 |
| 2 | 2 | 2 | {1: 1, 2: 2} | false | æ”¾å…¥æ¡¶ 2ï¼Œä¸ç›¸é‚»æ¡¶çš„å·®å€¼ä¸º 1 > t |
| 3 | 3 | 3 | {1: 1, 2: 2, 3: 3} | false | æ”¾å…¥æ¡¶ 3ï¼Œä¸ç›¸é‚»æ¡¶çš„å·®å€¼ä¸º 1 > t |
| 4 | 1 | 1 | {1: 1, 2: 2, 3: 3} | true | å‘ç°æ¡¶ 1 å·²æœ‰æ•°å­—ï¼Œä¸”å·®å€¼ä¸º 0 = t |

å¯¹äº t = 0 çš„æƒ…å†µï¼Œæˆ‘ä»¬åªéœ€è¦æ£€æŸ¥æ˜¯å¦æœ‰ç›¸åŒçš„æ•°å­—ï¼ˆå³åœ¨åŒä¸€ä¸ªæ¡¶ä¸­ï¼‰ã€‚
å¯¹äº t > 0 çš„æƒ…å†µï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ£€æŸ¥ç›¸é‚»çš„æ¡¶ã€‚

---

## ä»£ç å®ç°

å®Œæ•´çš„å¯è¿è¡Œä»£ç ï¼š[L0220_ContainsDuplicateIII.java](../src/main/java/L0220_ContainsDuplicateIII.java)

```java
public boolean containsNearbyAlmostDuplicate(int[] nums, int k, int t) {
    // ç‰¹æ®Šæƒ…å†µå¤„ç†
    if (nums == null || nums.length == 0 || k <= 0 || t < 0) {
        return false;
    }
    
    // ä½¿ç”¨æ¡¶æ’åºçš„æ€æƒ³ï¼Œæ¯ä¸ªæ¡¶çš„å¤§å°ä¸º t + 1
    // ä½¿ç”¨ long ç±»å‹é¿å…æ•´æ•°æº¢å‡º
    Map<Long, Long> bucket = new HashMap<>();
    long w = (long) t + 1;
    
    for (int i = 0; i < nums.length; i++) {
        // å°†æ•°å­—æ˜ å°„åˆ°æ¡¶ä¸­
        long id = getBucketId(nums[i], w);
        
        // å¦‚æœå½“å‰æ¡¶ä¸­å·²ç»æœ‰æ•°å­—ï¼Œè¯´æ˜æ‰¾åˆ°äº†ç¬¦åˆæ¡ä»¶çš„å€¼
        if (bucket.containsKey(id)) {
            return true;
        }
        
        // æ£€æŸ¥ç›¸é‚»çš„æ¡¶
        if (bucket.containsKey(id - 1) && Math.abs(nums[i] - bucket.get(id - 1)) < w) {
            return true;
        }
        if (bucket.containsKey(id + 1) && Math.abs(nums[i] - bucket.get(id + 1)) < w) {
            return true;
        }
        
        // å°†å½“å‰æ•°å­—æ”¾å…¥æ¡¶ä¸­
        bucket.put(id, (long) nums[i]);
        
        // å¦‚æœçª—å£è¶…è¿‡äº† kï¼Œç§»é™¤æœ€æ—©çš„æ•°å­—
        if (i >= k) {
            bucket.remove(getBucketId(nums[i - k], w));
        }
    }
    
    return false;
}

// è·å–æ¡¶çš„ ID
private long getBucketId(long num, long w) {
    // å¯¹äºè´Ÿæ•°è¦ç‰¹æ®Šå¤„ç†
    return num < 0 ? (num + 1) / w - 1 : num / w;
}
```

---

## å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„çš„é•¿åº¦
  - æˆ‘ä»¬åªéœ€è¦éå†ä¸€æ¬¡æ•°ç»„
  - HashMap çš„æŸ¥æ‰¾å’Œæ’å…¥æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸º O(1)

- **ç©ºé—´å¤æ‚åº¦**ï¼šO(min(n, k))
  - æ¡¶ä¸­æœ€å¤šå­˜å‚¨ k ä¸ªå…ƒç´ 
  - å› ä¸ºæˆ‘ä»¬ä¼šåœ¨çª—å£è¶…è¿‡ k æ—¶ç§»é™¤æœ€æ—©çš„å…ƒç´ 

---

## LeetCode é¢˜è§£

æœ¬é¢˜è§£æ˜¯ LeetCode ç³»åˆ—é¢˜è§£çš„ä¸€éƒ¨åˆ†ã€‚è¯¥ç³»åˆ—é¢˜è§£è‡´åŠ›äºå¸®åŠ©ç¨‹åºå‘˜æ›´å¥½åœ°ç†è§£å’ŒæŒæ¡ç®—æ³•æ€ç»´ï¼Œå†…å®¹åŒ…å«è¯¦ç»†çš„è§£é¢˜æ€è·¯åˆ†æã€å›¾æ–‡å¹¶èŒ‚çš„ç¤ºä¾‹è®²è§£å’Œå®Œæ•´çš„ä»£ç å®ç°ã€‚

<img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="GitHub" width="20" style="vertical-align: middle; margin-right: 5px"> [LeetCode æœ€å…¨é¢˜è§£](https://github.com/LjyYano/LeetCode)ï¼šæŒç»­æ›´æ–°ä¸­ï¼Œæ¬¢è¿ Star â­ï¸ å…³æ³¨ï¼Œä¸€èµ·æ¢è®¨ç®—æ³•ä¹‹ç¾ã€‚ 