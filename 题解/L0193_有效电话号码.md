---
title: 有效电话号码
date: 2025-02-09
---

## 题目描述

**🔗 题目**：[有效电话号码](https://leetcode.cn/problems/valid-phone-numbers/)  
**🏷️ 标签**：`Shell` `正则表达式`  
**🟡 难度**：`中等`  

给定一个包含电话号码列表（一行一个电话号码）的文本文件 file.txt，写一个单行 bash 脚本输出所有有效的电话号码。

你可以假设一个有效的电话号码必须满足以下两种格式之一：
1. (xxx) xxx-xxxx
2. xxx-xxx-xxxx
其中 x 表示一个数字。

你也可以假设每行前后没有多余的空格字符。

**示例：**

假设 file.txt 内容如下：
```
987-123-4567
123 456 7890
(123) 456-7890
```

你的脚本应当输出下列有效的电话号码：
```
987-123-4567
(123) 456-7890
```

---

## 解题思路

### 正则表达式匹配

#### 📝 核心思想
使用 `grep` 命令配合正则表达式来匹配符合要求的电话号码格式。正则表达式需要精确匹配两种格式：
1. xxx-xxx-xxxx 格式
2. (xxx) xxx-xxxx 格式

#### 🛠️ 实现步骤
1. 使用 `grep` 命令的 `-E` 选项启用扩展正则表达式
2. 构造正则表达式：
   - `^` 表示行的开始
   - `[0-9]{3}` 匹配三个数字
   - `\([0-9]{3}\)` 匹配被括号包围的三个数字
   - `[0-9]{3}-[0-9]{4}` 匹配后面的七个数字（中间有连字符）
   - `$` 表示行的结束
3. 使用 `|` 运算符组合两种格式的匹配

#### 🧩 示例分析
让我们分析正则表达式 `^([0-9]{3}-|\([0-9]{3}\) )[0-9]{3}-[0-9]{4}$` 的各个部分：

| 部分 | 说明 | 示例匹配 |
|-----|------|---------|
| `^` | 匹配行的开始 | - |
| `[0-9]{3}-` | 匹配三个数字后跟一个连字符 | "987-" |
| `\([0-9]{3}\) ` | 匹配括号内的三个数字后跟一个空格 | "(123) " |
| `\|` | 或运算符，表示匹配前面或后面的模式 | - |
| `[0-9]{3}-` | 匹配三个数字后跟一个连字符 | "123-" |
| `[0-9]{4}` | 匹配四个数字 | "4567" |
| `$` | 匹配行的结束 | - |

分析示例输入：

1. "987-123-4567"
   ```
   ^[0-9]{3}-     匹配 "987-"
   [0-9]{3}-      匹配 "123-"
   [0-9]{4}$      匹配 "4567"
   整体匹配成功
   ```

2. "123 456 7890"
   ```
   不符合任何格式
   整体匹配失败
   ```

3. "(123) 456-7890"
   ```
   ^\([0-9]{3}\)  匹配 "(123)"
   \s             匹配空格
   [0-9]{3}-      匹配 "456-"
   [0-9]{4}$      匹配 "7890"
   整体匹配成功
   ```

---

## 代码实现

完整的可运行代码：[L0193_ValidPhoneNumbers.sh](../src/main/shell/L0193_ValidPhoneNumbers.sh)

```bash
#!/bin/bash

# 使用 grep 命令匹配两种格式的电话号码
grep -E '^([0-9]{3}-|\([0-9]{3}\) )[0-9]{3}-[0-9]{4}$' file.txt
```

命令说明：
- `grep`：用于查找文件中符合条件的行
- `-E`：启用扩展正则表达式
- `^`：匹配行的开始
- `$`：匹配行的结束
- `[0-9]`：匹配一个数字
- `{3}`：匹配前面的模式三次
- `\(`：匹配左括号（需要转义）
- `\)`：匹配右括号（需要转义）
- `|`：或运算符
- `-`：匹配连字符

---

## 复杂度分析

- **时间复杂度**：O(n)
  - 需要读取文件的每一行
  - 对每一行进行正则表达式匹配
  - n 是文件的行数

- **空间复杂度**：O(1)
  - 只需要常数空间来存储正则表达式和当前处理的行
  - 不需要额外的数据结构

---

## LeetCode 题解

本题解是 LeetCode 系列题解的一部分。该系列题解致力于帮助程序员更好地理解和掌握算法思维，内容包含详细的解题思路分析、图文并茂的示例讲解和完整的代码实现。

<img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="GitHub" width="20" style="vertical-align: middle; margin-right: 5px"> [LeetCode 最全题解](https://github.com/LjyYano/LeetCode)：持续更新中，欢迎 Star ⭐️ 关注，一起探讨算法之美。 