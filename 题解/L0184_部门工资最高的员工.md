---
title: éƒ¨é—¨å·¥èµ„æœ€é«˜çš„å‘˜å·¥
date: 2025-02-09
---

## é¢˜ç›®æè¿°

**ğŸ”— é¢˜ç›®**ï¼š[éƒ¨é—¨å·¥èµ„æœ€é«˜çš„å‘˜å·¥](https://leetcode.cn/problems/department-highest-salary/)  
**ğŸ·ï¸ æ ‡ç­¾**ï¼š`æ•°æ®åº“`  
**ğŸŸ¡ éš¾åº¦**ï¼š`ä¸­ç­‰`  

è¡¨: Employee
```
+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| id          | int     |
| name        | varchar |
| salary      | int     |
| departmentId| int     |
+-------------+---------+
```
id æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚  
departmentId æ˜¯ Department è¡¨ä¸­ id çš„å¤–é”®ã€‚  
è¯¥è¡¨åŒ…å«å‘˜å·¥çš„ IDã€å§“åã€å·¥èµ„å’Œæ‰€å±éƒ¨é—¨çš„ IDã€‚  

è¡¨: Department
```
+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| id          | int     |
| name        | varchar |
+-------------+---------+
```
id æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚  
è¯¥è¡¨åŒ…å«å…¬å¸æ‰€æœ‰éƒ¨é—¨çš„ ID å’Œåç§°ã€‚  

ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼Œæ‰¾å‡ºæ¯ä¸ªéƒ¨é—¨ä¸­è–ªèµ„æœ€é«˜çš„å‘˜å·¥ã€‚  
ä»¥ ä»»æ„é¡ºåº è¿”å›ç»“æœè¡¨ã€‚  

ç¤ºä¾‹ 1ï¼š
```
è¾“å…¥ï¼š
Employee è¡¨ï¼š
+----+-------+--------+--------------+
| id | name  | salary | departmentId |
+----+-------+--------+--------------+
| 1  | Joe   | 70000  | 1            |
| 2  | Jim   | 90000  | 1            |
| 3  | Henry | 80000  | 2            |
| 4  | Sam   | 60000  | 2            |
| 5  | Max   | 90000  | 1            |
+----+-------+--------+--------------+
Department è¡¨ï¼š
+----+-------+
| id | name  |
+----+-------+
| 1  | IT    |
| 2  | Sales |
+----+-------+
è¾“å‡ºï¼š
+------------+----------+--------+
| Department | Employee | Salary |
+------------+----------+--------+
| IT         | Jim      | 90000  |
| IT         | Max      | 90000  |
| Sales      | Henry    | 80000  |
+------------+----------+--------+
è§£é‡Šï¼šåœ¨ IT éƒ¨é—¨ä¸­ï¼ŒJim å’Œ Max éƒ½æœ‰æœ€é«˜çš„è–ªèµ„ï¼Œä»–ä»¬çš„è–ªèµ„éƒ½æ˜¯ 90000ã€‚
åœ¨é”€å”®éƒ¨ä¸­ï¼ŒHenry çš„è–ªèµ„æœ€é«˜ï¼Œä¸º 80000ã€‚
```

---

## è§£é¢˜æ€è·¯

### ä½¿ç”¨å­æŸ¥è¯¢å’Œ IN æ“ä½œç¬¦

#### ğŸ“ æ ¸å¿ƒæ€æƒ³
1. é¦–å…ˆæ‰¾å‡ºæ¯ä¸ªéƒ¨é—¨çš„æœ€é«˜è–ªèµ„
2. ç„¶åä½¿ç”¨ IN æ“ä½œç¬¦æ‰¾å‡ºè–ªèµ„ç­‰äºéƒ¨é—¨æœ€é«˜è–ªèµ„çš„å‘˜å·¥
3. æœ€åé€šè¿‡è¿æ¥ Department è¡¨è·å–éƒ¨é—¨åç§°

#### ğŸ› ï¸ å®ç°æ­¥éª¤
1. ä½¿ç”¨å­æŸ¥è¯¢è·å–æ¯ä¸ªéƒ¨é—¨çš„æœ€é«˜è–ªèµ„ï¼š
   ```sql
   SELECT departmentId, MAX(salary)
   FROM Employee
   GROUP BY departmentId
   ```

2. ä½¿ç”¨ IN æ“ä½œç¬¦æ‰¾å‡ºè–ªèµ„ç­‰äºéƒ¨é—¨æœ€é«˜è–ªèµ„çš„å‘˜å·¥ï¼š
   ```sql
   WHERE (e.departmentId, e.salary) IN (å­æŸ¥è¯¢)
   ```

3. é€šè¿‡ JOIN è¿æ¥ Employee å’Œ Department è¡¨ï¼Œè·å–éƒ¨é—¨åç§°ï¼š
   ```sql
   FROM Employee e
   JOIN Department d ON e.departmentId = d.id
   ```

#### ğŸ§© ç¤ºä¾‹åˆ†æ
ä»¥ç¤ºä¾‹æ•°æ®ä¸ºä¾‹ï¼Œè®©æˆ‘ä»¬é€æ­¥åˆ†ææŸ¥è¯¢çš„æ‰§è¡Œè¿‡ç¨‹ï¼š

1. é¦–å…ˆè®¡ç®—æ¯ä¸ªéƒ¨é—¨çš„æœ€é«˜è–ªèµ„ï¼š
   | departmentId | MAX(salary) |
   |-------------|-------------|
   | 1           | 90000       |
   | 2           | 80000       |

2. ç„¶åæ‰¾å‡ºè–ªèµ„ç­‰äºéƒ¨é—¨æœ€é«˜è–ªèµ„çš„å‘˜å·¥ï¼š
   - IT éƒ¨é—¨ï¼ˆid=1ï¼‰ï¼šJim å’Œ Max çš„è–ªèµ„éƒ½æ˜¯ 90000
   - Sales éƒ¨é—¨ï¼ˆid=2ï¼‰ï¼šHenry çš„è–ªèµ„æ˜¯ 80000

3. æœ€åé€šè¿‡è¿æ¥ Department è¡¨è·å–éƒ¨é—¨åç§°ï¼Œå¾—åˆ°æœ€ç»ˆç»“æœï¼š
   | Department | Employee | Salary |
   |------------|----------|---------|
   | IT         | Jim      | 90000   |
   | IT         | Max      | 90000   |
   | Sales      | Henry    | 80000   |

---

## ä»£ç å®ç°

å®Œæ•´çš„å¯è¿è¡Œä»£ç ï¼š[L0184_DepartmentHighestSalary.java](../src/main/java/L0184_DepartmentHighestSalary.java)

```java
public String getSQL() {
    return "SELECT d.name AS Department, e.name AS Employee, e.salary AS Salary " +
           "FROM Employee e " +
           "JOIN Department d ON e.departmentId = d.id " +
           "WHERE (e.departmentId, e.salary) IN " +
           "(SELECT departmentId, MAX(salary) " +
           "FROM Employee " +
           "GROUP BY departmentId)";
}
```

---

## å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯ Employee è¡¨ä¸­çš„è®°å½•æ•°ã€‚éœ€è¦éå†ä¸€æ¬¡ Employee è¡¨æ¥æ‰¾å‡ºæ¯ä¸ªéƒ¨é—¨çš„æœ€é«˜è–ªèµ„ï¼Œç„¶åå†éå†ä¸€æ¬¡æ¥æ‰¾å‡ºå¯¹åº”çš„å‘˜å·¥ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼šO(m)ï¼Œå…¶ä¸­ m æ˜¯éƒ¨é—¨çš„æ•°é‡ã€‚éœ€è¦å­˜å‚¨æ¯ä¸ªéƒ¨é—¨çš„æœ€é«˜è–ªèµ„ã€‚

---

## LeetCode é¢˜è§£

æœ¬é¢˜è§£æ˜¯ LeetCode ç³»åˆ—é¢˜è§£çš„ä¸€éƒ¨åˆ†ã€‚è¯¥ç³»åˆ—é¢˜è§£è‡´åŠ›äºå¸®åŠ©ç¨‹åºå‘˜æ›´å¥½åœ°ç†è§£å’ŒæŒæ¡ç®—æ³•æ€ç»´ï¼Œå†…å®¹åŒ…å«è¯¦ç»†çš„è§£é¢˜æ€è·¯åˆ†æã€å›¾æ–‡å¹¶èŒ‚çš„ç¤ºä¾‹è®²è§£å’Œå®Œæ•´çš„ä»£ç å®ç°ã€‚

<img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="GitHub" width="20" style="vertical-align: middle; margin-right: 5px"> [LeetCode æœ€å…¨é¢˜è§£](https://github.com/LjyYano/LeetCode)ï¼šæŒç»­æ›´æ–°ä¸­ï¼Œæ¬¢è¿ Star â­ï¸ å…³æ³¨ï¼Œä¸€èµ·æ¢è®¨ç®—æ³•ä¹‹ç¾ã€‚ 