---
title: 部门工资最高的员工
date: 2025-02-09
---

## 题目描述

**🔗 题目**：[部门工资最高的员工](https://leetcode.cn/problems/department-highest-salary/)  
**🏷️ 标签**：`数据库`  
**🟡 难度**：`中等`  

表: Employee
```
+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| id          | int     |
| name        | varchar |
| salary      | int     |
| departmentId| int     |
+-------------+---------+
```
id 是该表的主键。  
departmentId 是 Department 表中 id 的外键。  
该表包含员工的 ID、姓名、工资和所属部门的 ID。  

表: Department
```
+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| id          | int     |
| name        | varchar |
+-------------+---------+
```
id 是该表的主键。  
该表包含公司所有部门的 ID 和名称。  

编写一个 SQL 查询，找出每个部门中薪资最高的员工。  
以 任意顺序 返回结果表。  

示例 1：
```
输入：
Employee 表：
+----+-------+--------+--------------+
| id | name  | salary | departmentId |
+----+-------+--------+--------------+
| 1  | Joe   | 70000  | 1            |
| 2  | Jim   | 90000  | 1            |
| 3  | Henry | 80000  | 2            |
| 4  | Sam   | 60000  | 2            |
| 5  | Max   | 90000  | 1            |
+----+-------+--------+--------------+
Department 表：
+----+-------+
| id | name  |
+----+-------+
| 1  | IT    |
| 2  | Sales |
+----+-------+
输出：
+------------+----------+--------+
| Department | Employee | Salary |
+------------+----------+--------+
| IT         | Jim      | 90000  |
| IT         | Max      | 90000  |
| Sales      | Henry    | 80000  |
+------------+----------+--------+
解释：在 IT 部门中，Jim 和 Max 都有最高的薪资，他们的薪资都是 90000。
在销售部中，Henry 的薪资最高，为 80000。
```

---

## 解题思路

### 使用子查询和 IN 操作符

#### 📝 核心思想
1. 首先找出每个部门的最高薪资
2. 然后使用 IN 操作符找出薪资等于部门最高薪资的员工
3. 最后通过连接 Department 表获取部门名称

#### 🛠️ 实现步骤
1. 使用子查询获取每个部门的最高薪资：
   ```sql
   SELECT departmentId, MAX(salary)
   FROM Employee
   GROUP BY departmentId
   ```

2. 使用 IN 操作符找出薪资等于部门最高薪资的员工：
   ```sql
   WHERE (e.departmentId, e.salary) IN (子查询)
   ```

3. 通过 JOIN 连接 Employee 和 Department 表，获取部门名称：
   ```sql
   FROM Employee e
   JOIN Department d ON e.departmentId = d.id
   ```

#### 🧩 示例分析
以示例数据为例，让我们逐步分析查询的执行过程：

1. 首先计算每个部门的最高薪资：
   | departmentId | MAX(salary) |
   |-------------|-------------|
   | 1           | 90000       |
   | 2           | 80000       |

2. 然后找出薪资等于部门最高薪资的员工：
   - IT 部门（id=1）：Jim 和 Max 的薪资都是 90000
   - Sales 部门（id=2）：Henry 的薪资是 80000

3. 最后通过连接 Department 表获取部门名称，得到最终结果：
   | Department | Employee | Salary |
   |------------|----------|---------|
   | IT         | Jim      | 90000   |
   | IT         | Max      | 90000   |
   | Sales      | Henry    | 80000   |

---

## 代码实现

完整的可运行代码：[L0184_DepartmentHighestSalary.java](../src/main/java/L0184_DepartmentHighestSalary.java)

```java
public String getSQL() {
    return "SELECT d.name AS Department, e.name AS Employee, e.salary AS Salary " +
           "FROM Employee e " +
           "JOIN Department d ON e.departmentId = d.id " +
           "WHERE (e.departmentId, e.salary) IN " +
           "(SELECT departmentId, MAX(salary) " +
           "FROM Employee " +
           "GROUP BY departmentId)";
}
```

---

## 复杂度分析

- **时间复杂度**：O(n)，其中 n 是 Employee 表中的记录数。需要遍历一次 Employee 表来找出每个部门的最高薪资，然后再遍历一次来找出对应的员工。
- **空间复杂度**：O(m)，其中 m 是部门的数量。需要存储每个部门的最高薪资。

---

## LeetCode 题解

本题解是 LeetCode 系列题解的一部分。该系列题解致力于帮助程序员更好地理解和掌握算法思维，内容包含详细的解题思路分析、图文并茂的示例讲解和完整的代码实现。

<img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="GitHub" width="20" style="vertical-align: middle; margin-right: 5px"> [LeetCode 最全题解](https://github.com/LjyYano/LeetCode)：持续更新中，欢迎 Star ⭐️ 关注，一起探讨算法之美。 