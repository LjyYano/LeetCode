---
title: éƒ¨é—¨å·¥èµ„æœ€é«˜çš„å‘˜å·¥
date: 2024-02-10
---

## é¢˜ç›®æè¿°

**ğŸ”— é¢˜ç›®**ï¼š[éƒ¨é—¨å·¥èµ„æœ€é«˜çš„å‘˜å·¥](https://leetcode.cn/problems/department-highest-salary/)  
**ğŸ·ï¸ æ ‡ç­¾**ï¼š`æ•°æ®åº“`  
**ğŸŸ¡ éš¾åº¦**ï¼š`ä¸­ç­‰`  

è¡¨: Employee
```
+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| id          | int     |
| name        | varchar |
| salary      | int     |
| departmentId| int     |
+-------------+---------+
```
id æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚  
departmentId æ˜¯ Department è¡¨ä¸­ id çš„å¤–é”®ã€‚  
è¯¥è¡¨åŒ…å«å‘˜å·¥çš„ä¿¡æ¯ã€‚  

è¡¨: Department
```
+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| id          | int     |
| name        | varchar |
+-------------+---------+
```
id æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚  
è¯¥è¡¨åŒ…å«å…¬å¸çš„éƒ¨é—¨ä¿¡æ¯ã€‚  

ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼Œæ‰¾å‡ºæ¯ä¸ªéƒ¨é—¨å·¥èµ„æœ€é«˜çš„å‘˜å·¥ã€‚  

ä»¥ ä»»æ„é¡ºåº è¿”å›ç»“æœè¡¨ã€‚  

ç¤ºä¾‹ï¼š  
è¾“å…¥ï¼š  
Employee è¡¨ï¼š
```
+----+-------+--------+--------------+
| id | name  | salary | departmentId |
+----+-------+--------+--------------+
| 1  | Joe   | 70000  | 1           |
| 2  | Jim   | 90000  | 1           |
| 3  | Henry | 80000  | 2           |
| 4  | Sam   | 60000  | 2           |
| 5  | Max   | 90000  | 1           |
+----+-------+--------+--------------+
```
Department è¡¨ï¼š
```
+----+-------+
| id | name  |
+----+-------+
| 1  | IT    |
| 2  | Sales |
+----+-------+
```
è¾“å‡ºï¼š
```
+------------+----------+--------+
| Department | Employee | Salary |
+------------+----------+--------+
| IT         | Jim      | 90000  |
| IT         | Max      | 90000  |
| Sales      | Henry    | 80000  |
+------------+----------+--------+
```
è§£é‡Šï¼šMax å’Œ Jim åœ¨ IT éƒ¨é—¨çš„å·¥èµ„éƒ½æ˜¯æœ€é«˜çš„ï¼Œä¸º 90000ã€‚  
Henry åœ¨é”€å”®éƒ¨çš„å·¥èµ„æœ€é«˜ï¼Œä¸º 80000ã€‚

---

## è§£é¢˜æ€è·¯

### å­æŸ¥è¯¢å’Œè¿æ¥æŸ¥è¯¢

#### ğŸ“ æ ¸å¿ƒæ€æƒ³
è¦æ‰¾å‡ºæ¯ä¸ªéƒ¨é—¨å·¥èµ„æœ€é«˜çš„å‘˜å·¥ï¼Œæˆ‘ä»¬éœ€è¦ï¼š
1. å…ˆæ‰¾å‡ºæ¯ä¸ªéƒ¨é—¨çš„æœ€é«˜å·¥èµ„
2. ç„¶åæ‰¾å‡ºå·¥èµ„ç­‰äºéƒ¨é—¨æœ€é«˜å·¥èµ„çš„å‘˜å·¥
3. æœ€åè¿æ¥éƒ¨é—¨è¡¨è·å–éƒ¨é—¨åç§°

è¿™éœ€è¦ç»“åˆä½¿ç”¨å­æŸ¥è¯¢å’Œè¿æ¥æŸ¥è¯¢ã€‚

#### ğŸ› ï¸ å®ç°æ­¥éª¤
1. ä½¿ç”¨å­æŸ¥è¯¢ `SELECT departmentId, MAX(salary) FROM Employee GROUP BY departmentId` è·å–æ¯ä¸ªéƒ¨é—¨çš„æœ€é«˜å·¥èµ„
2. ä½¿ç”¨ `WHERE (e.departmentId, e.salary) IN` æ‰¾å‡ºå·¥èµ„ç­‰äºéƒ¨é—¨æœ€é«˜å·¥èµ„çš„å‘˜å·¥
3. ä½¿ç”¨ `JOIN Department d ON e.departmentId = d.id` è¿æ¥éƒ¨é—¨è¡¨è·å–éƒ¨é—¨åç§°
4. ä½¿ç”¨ `SELECT` é€‰æ‹©éœ€è¦çš„å­—æ®µå¹¶é‡å‘½å

#### ğŸ§© ç¤ºä¾‹åˆ†æ
ä»¥ç¤ºä¾‹æ•°æ®ä¸ºä¾‹ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æŸ¥è¯¢æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼š

1. è®¡ç®—æ¯ä¸ªéƒ¨é—¨çš„æœ€é«˜å·¥èµ„ï¼š
   | departmentId | MAX(salary) |
   |-------------|-------------|
   | 1 (IT)      | 90000       |
   | 2 (Sales)   | 80000       |

2. æ‰¾å‡ºå·¥èµ„ç­‰äºéƒ¨é—¨æœ€é«˜å·¥èµ„çš„å‘˜å·¥ï¼š
   | id | name | salary | departmentId |
   |----|------|--------|-------------|
   | 2  | Jim  | 90000  | 1           |
   | 5  | Max  | 90000  | 1           |
   | 3  | Henry| 80000  | 2           |

3. è¿æ¥éƒ¨é—¨è¡¨åçš„ç»“æœï¼š
   | dept_name | emp_name | salary |
   |-----------|----------|---------|
   | IT        | Jim      | 90000   |
   | IT        | Max      | 90000   |
   | Sales     | Henry    | 80000   |

4. æœ€ç»ˆè¾“å‡ºï¼š
   ```
   +------------+----------+--------+
   | Department | Employee | Salary |
   +------------+----------+--------+
   | IT         | Jim      | 90000  |
   | IT         | Max      | 90000  |
   | Sales      | Henry    | 80000  |
   +------------+----------+--------+
   ```

---

## ä»£ç å®ç°

å®Œæ•´çš„å¯è¿è¡Œä»£ç ï¼š[L0184_DepartmentHighestSalary.sql](../src/main/sql/L0184_DepartmentHighestSalary.sql)

```sql
SELECT d.name AS Department,
    e.name AS Employee,
    e.salary AS Salary
FROM Employee e
JOIN Department d ON e.departmentId = d.id
WHERE (e.departmentId, e.salary) IN (
    SELECT departmentId, MAX(salary)
    FROM Employee
    GROUP BY departmentId
)
```

---

## å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼šO(n + m)ï¼Œå…¶ä¸­ n æ˜¯ Employee è¡¨çš„è®°å½•æ•°ï¼Œm æ˜¯ Department è¡¨çš„è®°å½•æ•°
  - éœ€è¦éå† Employee è¡¨è®¡ç®—æ¯ä¸ªéƒ¨é—¨çš„æœ€é«˜å·¥èµ„
  - éœ€è¦å†æ¬¡éå† Employee è¡¨æ‰¾å‡ºæœ€é«˜å·¥èµ„çš„å‘˜å·¥
  - éœ€è¦è¿æ¥ Department è¡¨è·å–éƒ¨é—¨åç§°
  - ä½¿ç”¨ç´¢å¼•å¯ä»¥ä¼˜åŒ–æŸ¥æ‰¾æ€§èƒ½

- **ç©ºé—´å¤æ‚åº¦**ï¼šO(n)
  - éœ€è¦å­˜å‚¨æ¯ä¸ªéƒ¨é—¨çš„æœ€é«˜å·¥èµ„ä¿¡æ¯
  - éœ€è¦å­˜å‚¨è¿æ¥æ“ä½œçš„ä¸­é—´ç»“æœ
  - n æ˜¯ Employee è¡¨çš„è®°å½•æ•°

---

## LeetCode é¢˜è§£

æœ¬é¢˜è§£æ˜¯ LeetCode ç³»åˆ—é¢˜è§£çš„ä¸€éƒ¨åˆ†ã€‚è¯¥ç³»åˆ—é¢˜è§£è‡´åŠ›äºå¸®åŠ©ç¨‹åºå‘˜æ›´å¥½åœ°ç†è§£å’ŒæŒæ¡ç®—æ³•æ€ç»´ï¼Œå†…å®¹åŒ…å«è¯¦ç»†çš„è§£é¢˜æ€è·¯åˆ†æã€å›¾æ–‡å¹¶èŒ‚çš„ç¤ºä¾‹è®²è§£å’Œå®Œæ•´çš„ä»£ç å®ç°ã€‚

<img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="GitHub" width="20" style="vertical-align: middle; margin-right: 5px"> [LeetCode æœ€å…¨é¢˜è§£](https://github.com/LjyYano/LeetCode)ï¼šæŒç»­æ›´æ–°ä¸­ï¼Œæ¬¢è¿ Star â­ï¸ å…³æ³¨ï¼Œä¸€èµ·æ¢è®¨ç®—æ³•ä¹‹ç¾ã€‚ 