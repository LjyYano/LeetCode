---
title: 插入区间
date: 2025-02-09
---

## 题目描述

**🔗 题目**：[插入区间](https://leetcode.cn/problems/insert-interval/)  
**🏷️ 标签**：`数组` `排序`  
**🟡 难度**：`中等`  

给你一个 无重叠的 ，按照区间起始端点排序的区间列表。

在列表中插入一个新的区间，你需要确保列表中的区间仍然有序且不重叠（如果有必要的话，可以合并区间）。

示例 1：
```
输入：intervals = [[1,3],[6,9]], newInterval = [2,5]
输出：[[1,5],[6,9]]
```

示例 2：
```
输入：intervals = [[1,2],[3,5],[6,7],[8,10],[12,16]], newInterval = [4,8]
输出：[[1,2],[3,10],[12,16]]
解释：这是因为新的区间 [4,8] 与 [3,5],[6,7],[8,10] 重叠。
```

示例 3：
```
输入：intervals = [], newInterval = [5,7]
输出：[[5,7]]
```

示例 4：
```
输入：intervals = [[1,5]], newInterval = [2,3]
输出：[[1,5]]
```

示例 5：
```
输入：intervals = [[1,5]], newInterval = [2,7]
输出：[[1,7]]
```

提示：
- 0 <= intervals.length <= 10⁴
- intervals[i].length == 2
- 0 <= intervals[i][0] <= intervals[i][1] <= 10⁵
- intervals 根据 intervals[i][0] 按 升序 排列
- newInterval.length == 2
- 0 <= newInterval[0] <= newInterval[1] <= 10⁵

---

## 解题思路
### 线性扫描法

#### 📝 核心思想
1. 将问题分为三个阶段：
   - 找到所有在新区间之前的区间（不重叠）
   - 找到所有与新区间重叠的区间并合并
   - 找到所有在新区间之后的区间（不重叠）
2. 利用原区间列表已经按起始端点排序的特性
3. 通过一次线性扫描完成所有操作

#### 🛠️ 实现步骤
1. 创建结果列表
2. 遍历原区间列表：
   - 将所有在新区间之前的区间加入结果集
   - 合并所有与新区间重叠的区间
   - 将合并后的新区间加入结果集
   - 将所有在新区间之后的区间加入结果集
3. 将结果列表转换为数组返回

#### 🧩 示例分析
以示例 1 为例，intervals = [[1,3],[6,9]], newInterval = [2,5]：

| 阶段 | 当前处理 | 结果集 | 说明 |
|-----|---------|-------|------|
| 初始状态 | - | [] | 准备开始处理 |
| 第一阶段 | [1,3] | [[1,3]] | 不能直接加入，因为与新区间重叠 |
| 第二阶段 | [2,5] | [[1,5]] | 与 [1,3] 合并为 [1,5] |
| 第三阶段 | [6,9] | [[1,5],[6,9]] | 直接加入，因为不重叠 |

区间处理示意图：
```
阶段 1：检查 [1,3] 与新区间 [2,5] 的关系
1   2   3   4   5   6   7   8   9
|───────|
    |───────────|
|───────────────|  ← 合并后

阶段 2：检查 [6,9] 与合并后区间的关系
1   2   3   4   5   6   7   8   9
|───────────────|  |───────────|
```

以示例 2 为例，intervals = [[1,2],[3,5],[6,7],[8,10],[12,16]], newInterval = [4,8]：

| 阶段 | 当前处理 | 结果集 | 说明 |
|-----|---------|-------|------|
| 初始状态 | - | [] | 准备开始处理 |
| 第一阶段 | [1,2] | [[1,2]] | 直接加入，因为在新区间之前 |
| 第二阶段 | [3,5] | [[1,2],[3,5]] | 与新区间重叠，开始合并 |
| 第二阶段 | [6,7] | [[1,2],[3,8]] | 继续合并 |
| 第二阶段 | [8,10] | [[1,2],[3,10]] | 继续合并 |
| 第三阶段 | [12,16] | [[1,2],[3,10],[12,16]] | 直接加入，因为在新区间之后 |

区间处理示意图：
```
阶段 1：[1,2] 在新区间之前
1   2   3   4   5   6   7   8   9   10  11  12  13  14  15  16
|───|

阶段 2：合并重叠区间
1   2   3   4   5   6   7   8   9   10  11  12  13  14  15  16
|───|   |───────|   |───|   |───────|           |─────────────|
        ↑   [4,8]   ↑       ↑
        合并这些区间 →  |────────────|

最终结果：
1   2   3   4   5   6   7   8   9   10  11  12  13  14  15  16
|───|   |───────────────────────|           |─────────────|
```

特殊情况分析：
1. 空区间列表：
```
intervals = []
newInterval = [5,7]
直接返回 [[5,7]]
```

2. 新区间被包含：
```
intervals = [[1,5]]
newInterval = [2,3]
返回 [[1,5]]，因为新区间完全被包含
```

3. 新区间包含原区间：
```
intervals = [[1,5]]
newInterval = [2,7]
返回 [[1,7]]，因为需要扩展原区间的结束位置
```

---

## 代码实现

完整的可运行代码：[L0057_InsertInterval.java](../src/main/java/L0057_InsertInterval.java)

```java
public int[][] insert(int[][] intervals, int[] newInterval) {
    // 如果原区间列表为空，直接返回新区间
    if (intervals == null || intervals.length == 0) {
        return new int[][] {newInterval};
    }
    
    // 用于存储结果的列表
    List<int[]> result = new ArrayList<>();
    // 当前处理到的位置
    int i = 0;
    // 区间数组的长度
    int n = intervals.length;
    
    // 将所有在新区间之前的区间加入结果集
    while (i < n && intervals[i][1] < newInterval[0]) {
        result.add(intervals[i]);
        i++;
    }
    
    // 合并所有与新区间重叠的区间
    while (i < n && intervals[i][0] <= newInterval[1]) {
        // 更新新区间的起始和结束位置
        newInterval[0] = Math.min(newInterval[0], intervals[i][0]);
        newInterval[1] = Math.max(newInterval[1], intervals[i][1]);
        i++;
    }
    // 将合并后的新区间加入结果集
    result.add(newInterval);
    
    // 将所有在新区间之后的区间加入结果集
    while (i < n) {
        result.add(intervals[i]);
        i++;
    }
    
    // 将列表转换为数组返回
    return result.toArray(new int[result.size()][]);
}
```

---

## 复杂度分析

- **时间复杂度**：O(n)，其中 n 是原区间列表的长度。我们只需要遍历一次区间列表。
- **空间复杂度**：O(n)，需要存储合并后的区间。如果不考虑返回值的空间，则空间复杂度为 O(1)。

---

## LeetCode 题解

本题解是 LeetCode 系列题解的一部分。该系列题解致力于帮助程序员更好地理解和掌握算法思维，内容包含详细的解题思路分析、图文并茂的示例讲解和完整的代码实现。

<img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="GitHub" width="20" style="vertical-align: middle; margin-right: 5px"> [LeetCode 最全题解](https://github.com/LjyYano/LeetCode)：持续更新中，欢迎 Star ⭐️ 关注，一起探讨算法之美。 