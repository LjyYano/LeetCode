---
title: ç»™è¡¨è¾¾å¼æ·»åŠ è¿ç®—ç¬¦
date: 2024-03-24
---

## é¢˜ç›®æè¿°

**ğŸ”— é¢˜ç›®**ï¼š[ç»™è¡¨è¾¾å¼æ·»åŠ è¿ç®—ç¬¦](https://leetcode.cn/problems/expression-add-operators/)  
**ğŸ·ï¸ æ ‡ç­¾**ï¼š`æ•°å­¦` `å­—ç¬¦ä¸²` `å›æº¯`  
**ğŸ”´ éš¾åº¦**ï¼š`å›°éš¾`  

ç»™å®šä¸€ä¸ªä»…åŒ…å«æ•°å­—çš„å­—ç¬¦ä¸² num å’Œä¸€ä¸ªç›®æ ‡å€¼ targetï¼Œåœ¨ num çš„æ•°å­—ä¹‹é—´æ·»åŠ  äºŒå…ƒ è¿ç®—ç¬¦ï¼ˆä¸æ˜¯ä¸€å…ƒï¼‰+ã€- æˆ– * ï¼Œè¿”å› æ‰€æœ‰ èƒ½å¤Ÿå¾—åˆ° target çš„è¡¨è¾¾å¼ã€‚

æ³¨æ„ï¼Œè¿”å›è¡¨è¾¾å¼ä¸­çš„æ“ä½œæ•° ä¸åº”è¯¥ åŒ…å«å‰å¯¼é›¶ã€‚

ç¤ºä¾‹ 1:
```
è¾“å…¥: num = "123", target = 6
è¾“å‡º: ["1+2+3", "1*2*3"] 
```

ç¤ºä¾‹ 2:
```
è¾“å…¥: num = "232", target = 8
è¾“å‡º: ["2*3+2", "2+3*2"]
```

ç¤ºä¾‹ 3:
```
è¾“å…¥: num = "3456237490", target = 9191
è¾“å‡º: []
```

æç¤ºï¼š
- 1 <= num.length <= 10
- num ä»…å«æ•°å­—
- -2Â³Â¹ <= target <= 2Â³Â¹ - 1

---

## è§£é¢˜æ€è·¯
### å›æº¯æ³•

#### ğŸ“ æ ¸å¿ƒæ€æƒ³
è¿™é“é¢˜å¯ä»¥ä½¿ç”¨å›æº¯æ³•æ¥è§£å†³ã€‚ä¸»è¦æ€è·¯æ˜¯ï¼š
1. ä»å·¦åˆ°å³éå†å­—ç¬¦ä¸²ï¼Œåœ¨æ¯ä¸ªä½ç½®å°è¯•æ·»åŠ ä¸åŒçš„è¿ç®—ç¬¦
2. éœ€è¦ç‰¹åˆ«å¤„ç†ä¹˜æ³•è¿ç®—ï¼Œå› ä¸ºä¹˜æ³•çš„ä¼˜å…ˆçº§é«˜äºåŠ å‡æ³•
3. éœ€è¦å¤„ç†å‰å¯¼é›¶çš„æƒ…å†µ
4. ä½¿ç”¨é•¿æ•´å‹é¿å…æ•´æ•°æº¢å‡º

#### ğŸ› ï¸ å®ç°æ­¥éª¤
1. åˆå§‹åŒ–ï¼š
   - åˆ›å»ºç»“æœåˆ—è¡¨å­˜å‚¨æ‰€æœ‰æœ‰æ•ˆè¡¨è¾¾å¼
   - ä½¿ç”¨ StringBuilder æ„å»ºå½“å‰è¡¨è¾¾å¼
   - è®°å½•å½“å‰è¡¨è¾¾å¼çš„è®¡ç®—ç»“æœå’Œä¸Šä¸€ä¸ªä¹˜æ³•æ“ä½œçš„ç»“æœ

2. å›æº¯è¿‡ç¨‹ï¼š
   - å¦‚æœå·²å¤„ç†å®Œæ‰€æœ‰æ•°å­—ï¼Œæ£€æŸ¥ç»“æœæ˜¯å¦ç­‰äºç›®æ ‡å€¼
   - è®°å½•å½“å‰è¡¨è¾¾å¼é•¿åº¦ï¼Œç”¨äºå›æº¯
   - è·å–å½“å‰ä½ç½®çš„æ•°å­—ï¼Œæ³¨æ„å¤„ç†å‰å¯¼é›¶
   - å°è¯•æ·»åŠ ä¸åŒçš„è¿ç®—ç¬¦ï¼ˆ+ã€-ã€*ï¼‰
   - é€’å½’å¤„ç†ä¸‹ä¸€ä¸ªä½ç½®
   - å›æº¯åˆ°ä¹‹å‰çš„çŠ¶æ€

3. ç‰¹æ®Šæƒ…å†µå¤„ç†ï¼š
   - ç¬¬ä¸€ä¸ªæ•°å­—ä¸éœ€è¦æ·»åŠ è¿ç®—ç¬¦
   - å¤„ç†å‰å¯¼é›¶
   - å¤„ç†ä¹˜æ³•ä¼˜å…ˆçº§

#### ğŸ§© ç¤ºä¾‹åˆ†æ
ä»¥è¾“å…¥ `num = "123", target = 6` ä¸ºä¾‹ï¼Œåˆ†æå›æº¯è¿‡ç¨‹ï¼š

1. å¤„ç†ç¬¬ä¸€ä¸ªæ•°å­— "1"ï¼š
   ```
   expr = "1"
   eval = 1
   multed = 1
   ```

2. å¤„ç†ç¬¬äºŒä¸ªæ•°å­— "2"ï¼Œå°è¯•ä¸åŒè¿ç®—ç¬¦ï¼š
   ```
   å°è¯• +ï¼š
   expr = "1+2"
   eval = 3
   multed = 2

   å°è¯• -ï¼š
   expr = "1-2"
   eval = -1
   multed = -2

   å°è¯• *ï¼š
   expr = "1*2"
   eval = 2
   multed = 2
   ```

3. å¤„ç†ç¬¬ä¸‰ä¸ªæ•°å­— "3"ï¼Œç»§ç»­å°è¯•ä¸åŒè¿ç®—ç¬¦ï¼š
   ```
   å¯¹äº "1+2"ï¼š
   å°è¯• +ï¼šexpr = "1+2+3", eval = 6 âœ“
   å°è¯• -ï¼šexpr = "1+2-3", eval = 0 âœ—
   å°è¯• *ï¼šexpr = "1+2*3", eval = 7 âœ—

   å¯¹äº "1-2"ï¼š
   å°è¯• +ï¼šexpr = "1-2+3", eval = 2 âœ—
   å°è¯• -ï¼šexpr = "1-2-3", eval = -4 âœ—
   å°è¯• *ï¼šexpr = "1-2*3", eval = -5 âœ—

   å¯¹äº "1*2"ï¼š
   å°è¯• +ï¼šexpr = "1*2+3", eval = 5 âœ—
   å°è¯• -ï¼šexpr = "1*2-3", eval = -1 âœ—
   å°è¯• *ï¼šexpr = "1*2*3", eval = 6 âœ“
   ```

æœ€ç»ˆæ‰¾åˆ°ä¸¤ä¸ªè§£ï¼š`"1+2+3"` å’Œ `"1*2*3"`ã€‚

---

## ä»£ç å®ç°

å®Œæ•´çš„å¯è¿è¡Œä»£ç ï¼š[L0282_ExpressionAddOperators.java](../src/main/java/L0282_ExpressionAddOperators.java)

```java
public List<String> addOperators(String num, int target) {
    List<String> result = new ArrayList<>();
    if (num == null || num.length() == 0) {
        return result;
    }
    
    backtrack(result, num, target, 0, 0, 0, new StringBuilder());
    return result;
}

private void backtrack(List<String> result, String num, int target, int index, 
        long eval, long multed, StringBuilder expr) {
    // å¦‚æœå·²ç»å¤„ç†å®Œæ‰€æœ‰æ•°å­—
    if (index == num.length()) {
        // å¦‚æœå½“å‰è¡¨è¾¾å¼çš„å€¼ç­‰äºç›®æ ‡å€¼ï¼Œå°†è¡¨è¾¾å¼æ·»åŠ åˆ°ç»“æœåˆ—è¡¨
        if (eval == target) {
            result.add(expr.toString());
        }
        return;
    }
    
    // è®°å½•å½“å‰è¡¨è¾¾å¼çš„é•¿åº¦ï¼Œç”¨äºå›æº¯
    int len = expr.length();
    
    // å¦‚æœä¸æ˜¯ç¬¬ä¸€ä¸ªæ•°å­—ï¼Œéœ€è¦æ·»åŠ æ“ä½œç¬¦
    if (index != 0) {
        expr.append(" ");
    }
    
    // è·å–å½“å‰ä½ç½®çš„æ•°å­—
    long cur = 0;
    // å¤„ç†æ•°å­—ï¼Œæ³¨æ„å‰å¯¼é›¶çš„æƒ…å†µ
    for (int i = index; i < num.length(); i++) {
        // å¦‚æœæ•°å­—ä»¥0å¼€å¤´ä¸”é•¿åº¦å¤§äº1ï¼Œè·³è¿‡
        if (i != index && num.charAt(index) == '0') {
            break;
        }
        cur = cur * 10 + (num.charAt(i) - '0');
        
        // å¦‚æœæ˜¯ç¬¬ä¸€ä¸ªæ•°å­—ï¼Œä¸éœ€è¦æ·»åŠ æ“ä½œç¬¦
        if (index == 0) {
            backtrack(result, num, target, i + 1, cur, cur, expr.append(cur));
            expr.setLength(len);
            continue;
        }
        
        // å°è¯•åŠ æ³•
        expr.append("+").append(cur);
        backtrack(result, num, target, i + 1, eval + cur, cur, expr);
        expr.setLength(len);
        
        // å°è¯•å‡æ³•
        expr.append("-").append(cur);
        backtrack(result, num, target, i + 1, eval - cur, -cur, expr);
        expr.setLength(len);
        
        // å°è¯•ä¹˜æ³•
        expr.append("*").append(cur);
        backtrack(result, num, target, i + 1, eval - multed + multed * cur, multed * cur, expr);
        expr.setLength(len);
    }
}
```

---

## å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼šO(4^n)ï¼Œå…¶ä¸­ n æ˜¯è¾“å…¥å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚
  - å¯¹äºæ¯ä¸ªæ•°å­—ä¹‹é—´çš„ä½ç½®ï¼Œæˆ‘ä»¬æœ‰ 4 ç§é€‰æ‹©ï¼ˆä¸æ·»åŠ è¿ç®—ç¬¦ï¼Œæˆ–æ·»åŠ  +ã€-ã€*ï¼‰
  - éœ€è¦éå†æ‰€æœ‰å¯èƒ½çš„ç»„åˆ

- **ç©ºé—´å¤æ‚åº¦**ï¼šO(n)
  - é€’å½’è°ƒç”¨æ ˆçš„æ·±åº¦ä¸º O(n)
  - StringBuilder å­˜å‚¨å½“å‰è¡¨è¾¾å¼éœ€è¦ O(n) ç©ºé—´

---

## LeetCode é¢˜è§£

æœ¬é¢˜è§£æ˜¯ LeetCode ç³»åˆ—é¢˜è§£çš„ä¸€éƒ¨åˆ†ã€‚è¯¥ç³»åˆ—é¢˜è§£è‡´åŠ›äºå¸®åŠ©ç¨‹åºå‘˜æ›´å¥½åœ°ç†è§£å’ŒæŒæ¡ç®—æ³•æ€ç»´ï¼Œå†…å®¹åŒ…å«è¯¦ç»†çš„è§£é¢˜æ€è·¯åˆ†æã€å›¾æ–‡å¹¶èŒ‚çš„ç¤ºä¾‹è®²è§£å’Œå®Œæ•´çš„ä»£ç å®ç°ã€‚

<img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="GitHub" width="20" style="vertical-align: middle; margin-right: 5px"> [LeetCode æœ€å…¨é¢˜è§£](https://github.com/LjyYano/LeetCode)ï¼šæŒç»­æ›´æ–°ä¸­ï¼Œæ¬¢è¿ Star â­ï¸ å…³æ³¨ï¼Œä¸€èµ·æ¢è®¨ç®—æ³•ä¹‹ç¾ã€‚ 