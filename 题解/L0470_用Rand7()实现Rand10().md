---
title: 用 Rand7() 实现 Rand10()
date: 2024-03-19
---

## 题目描述

**🔗 题目**：[用 Rand7() 实现 Rand10()](https://leetcode.cn/problems/implement-rand10-using-rand7/)  
**🏷️ 标签**：`随机` `概率` `拒绝采样`  
**🟡 难度**：`中等`  

给定方法 rand7() 可生成 [1,7] 范围内的均匀随机整数，试写一个方法 rand10() 生成 [1,10] 范围内的均匀随机整数。

你只能调用 rand7() 且不能调用其他方法。请不要使用系统的 Math.random() 方法。

每个测试用例将有一个内部参数 n，即你实现的函数 rand10() 在测试时将被调用的次数。请注意，这不是传递给 rand10() 的参数。

示例 1：
输入: 1
输出: [2]

示例 2：
输入: 2
输出: [2,8]

示例 3：
输入: 3
输出: [3,8,10]

提示：
1 <= n <= 10⁵

进阶：
rand7() 调用次数的 期望值 是多少？
你能否尽量少调用 rand7()?

---

## 解题思路
### 拒绝采样法

#### 📝 核心思想
本题的关键是如何利用 rand7() 生成一个均匀分布的 rand10()。我们需要先生成一个更大范围的均匀随机数，然后通过拒绝采样的方式将其映射到 [1,10] 范围。

#### 🛠️ 实现步骤
1. 使用 (rand7() - 1) * 7 + rand7() 生成 [1,49] 范围的随机数
2. 如果生成的数大于 40，则拒绝并重新生成
3. 将 [1,40] 范围内的数映射到 [1,10] 范围

#### 🧩 示例分析
以生成一个 [1,10] 范围的随机数为例：

1. 第一次尝试：
```
rand7() = 3, (3-1)*7 = 14
rand7() = 5, 14+5 = 19
19 ≤ 40，可以使用
映射：1 + (19-1)%10 = 9
```

2. 第二次尝试（假设）：
```
rand7() = 7, (7-1)*7 = 42
rand7() = 6, 42+6 = 48
48 > 40，拒绝，重新生成
```

3. 第三次尝试（假设）：
```
rand7() = 4, (4-1)*7 = 21
rand7() = 3, 21+3 = 24
24 ≤ 40，可以使用
映射：1 + (24-1)%10 = 4
```

映射过程表格展示：
| 原始范围 | 映射后的值 | 计算方式 |
|---------|-----------|---------|
| 1-10 | 1-10 | 1 + (num-1)%10 |
| 11-20 | 1-10 | 1 + (num-1)%10 |
| 21-30 | 1-10 | 1 + (num-1)%10 |
| 31-40 | 1-10 | 1 + (num-1)%10 |
| 41-49 | 拒绝 | 重新生成 |

---

## 代码实现

完整的可运行代码：[L0470_ImplementRand10UsingRand7.java](../src/main/java/L0470_ImplementRand10UsingRand7.java)

```java
public int rand10() {
    while (true) {
        // 首先使用 rand7() 生成 [1,49] 范围内的随机数
        // (rand7() - 1) * 7 生成 [0,42] 范围内的随机数
        // rand7() 生成 [1,7] 范围内的随机数
        int num = (rand7() - 1) * 7 + rand7();
        // 如果生成的数大于 40，则重新生成
        // 因为 41-49 这些数不能均匀地映射到 1-10
        if (num <= 40) {
            // 将 [1,40] 映射到 [1,10]
            return 1 + (num - 1) % 10;
        }
    }
}
```

---

## 复杂度分析

- **时间复杂度**：期望 O(1)，最坏情况下为 O(∞)
  - 在一次循环中生成所需数字的概率是 40/49
  - 期望的循环次数是 49/40 ≈ 1.23
  - 所以平均情况下，我们只需要少量的循环就能得到结果

- **空间复杂度**：O(1)
  - 只需要常数级的额外空间存储变量

---

## LeetCode 题解

本题解是 LeetCode 系列题解的一部分。该系列题解致力于帮助程序员更好地理解和掌握算法思维，内容包含详细的解题思路分析、图文并茂的示例讲解和完整的代码实现。

<img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="GitHub" width="20" style="vertical-align: middle; margin-right: 5px"> [LeetCode 最全题解](https://github.com/LjyYano/LeetCode)：持续更新中，欢迎 Star ⭐️ 关注，一起探讨算法之美。