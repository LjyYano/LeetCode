# 用 Rand7() 实现 Rand10()

## 题目描述

给定方法 `rand7()` 可生成 `[1,7]` 范围内的均匀随机整数，试写一个方法 `rand10()` 生成 `[1,10]` 范围内的均匀随机整数。

你只能调用 `rand7()` 且不能调用其他方法。请不要使用系统的 `Math.random()` 方法。

每个测试用例将有一个内部参数 n，即你实现的函数 `rand10()` 在测试时将被调用的次数。请注意，这不是传递给 `rand10()` 的参数。

## 解题思路

这道题的核心是如何利用已有的 `rand7()` 函数来生成一个均匀分布的 `rand10()` 函数。主要思路如下：

1. 首先，我们需要使用 `rand7()` 生成一个更大范围的均匀随机数，然后再将其映射到 `[1,10]` 范围内。

2. 使用 `(rand7() - 1) * 7 + rand7()` 可以生成 `[1,49]` 范围内的均匀随机数：
   - `rand7() - 1` 生成 `[0,6]` 范围的数
   - 乘以 7 后生成 `[0,42]` 范围的数
   - 再加上一个 `rand7()` 就可以生成 `[1,49]` 范围的数

3. 为什么要生成 `[1,49]` 范围的数？
   - 我们需要一个能被 10 整除的数作为上界，这样才能均匀地映射到 `[1,10]`
   - 49 中我们可以使用前 40 个数（`[1,40]`），因为 40 可以被 10 整除
   - 如果生成的数大于 40，我们就重新生成，直到得到一个小于等于 40 的数

4. 最后，我们将 `[1,40]` 范围内的数映射到 `[1,10]` 范围：
   - 使用 `1 + (num - 1) % 10` 进行映射
   - 这样可以保证生成的数是均匀分布的

## 代码实现

```java
public int rand10() {
    while (true) {
        // 首先使用 rand7() 生成 [1,49] 范围内的随机数
        // (rand7() - 1) * 7 生成 [0,42] 范围内的随机数
        // rand7() 生成 [1,7] 范围内的随机数
        int num = (rand7() - 1) * 7 + rand7();
        // 如果生成的数大于 40，则重新生成
        // 因为 41-49 这些数不能均匀地映射到 1-10
        if (num <= 40) {
            // 将 [1,40] 映射到 [1,10]
            return 1 + (num - 1) % 10;
        }
    }
}
```

## 复杂度分析

- 时间复杂度：期望 O(1)，但最坏情况下可能是 O(∞)。
  - 在一次循环中生成所需数字的概率是 40/49
  - 期望的循环次数是 49/40 ≈ 1.23
  - 所以平均情况下，我们只需要少量的循环就能得到结果

- 空间复杂度：O(1)，只需要常数级的额外空间。

## 进阶问题解答

1. `rand7()` 调用次数的期望值是多少？
   - 每次循环调用 2 次 `rand7()`
   - 期望的循环次数是 49/40
   - 所以 `rand7()` 的期望调用次数是 2 * 49/40 ≈ 2.45 次

2. 如何尽量少调用 `rand7()`？
   - 当前的实现已经是比较优的方案了
   - 我们可以通过缓存之前被拒绝的随机数来稍微优化，但实现会更复杂
   - 理论上的最小期望调用次数是 log_7(10) ≈ 1.183，但实际上很难达到

## 总结

这道题的关键点在于：

1. 如何通过已有的随机数生成器生成更大范围的均匀随机数
2. 如何将大范围的随机数均匀地映射到目标范围
3. 处理拒绝采样的情况，确保最终结果的均匀性

这种通过小范围随机数生成大范围随机数的思想在实际工程中也很有用，比如在需要生成特定范围随机数但只有系统提供的随机数生成器时。 