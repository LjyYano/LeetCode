---
title: è®¾è®¡æ¨ç‰¹
date: 2025-02-11
---

## é¢˜ç›®æè¿°

**ğŸ”— é¢˜ç›®**ï¼š[è®¾è®¡æ¨ç‰¹](https://leetcode.cn/problems/design-twitter/)  
**ğŸ·ï¸ æ ‡ç­¾**ï¼š`è®¾è®¡` `å“ˆå¸Œè¡¨` `é“¾è¡¨` `å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰`  
**ğŸŸ¡ éš¾åº¦**ï¼š`ä¸­ç­‰`  

è®¾è®¡ä¸€ä¸ªç®€åŒ–ç‰ˆçš„æ¨ç‰¹(Twitter)ï¼Œå¯ä»¥è®©ç”¨æˆ·å®ç°å‘é€æ¨æ–‡ï¼Œå…³æ³¨/å–æ¶ˆå…³æ³¨å…¶ä»–ç”¨æˆ·ï¼Œèƒ½å¤Ÿçœ‹è§å…³æ³¨äººï¼ˆåŒ…æ‹¬è‡ªå·±ï¼‰çš„æœ€è¿‘ 10 æ¡æ¨æ–‡ã€‚

å®ç° Twitter ç±»ï¼š
- Twitter() åˆå§‹åŒ–ç®€æ˜“ç‰ˆæ¨ç‰¹å¯¹è±¡
- void postTweet(int userId, int tweetId) æ ¹æ®ç»™å®šçš„ tweetId å’Œ userId åˆ›å»ºä¸€æ¡æ–°æ¨æ–‡ã€‚æ¯æ¬¡è°ƒç”¨æ­¤å‡½æ•°éƒ½ä¼šä½¿ç”¨ä¸€ä¸ªä¸åŒçš„ tweetId ã€‚
- List<Integer> getNewsFeed(int userId) æ£€ç´¢å½“å‰ç”¨æˆ·æ–°é—»æ¨é€ä¸­æœ€è¿‘ 10 æ¡æ¨æ–‡çš„ ID ã€‚æ–°é—»æ¨é€ä¸­çš„æ¯ä¸€é¡¹éƒ½å¿…é¡»æ˜¯ç”±ç”¨æˆ·å…³æ³¨çš„äººæˆ–è€…æ˜¯ç”¨æˆ·è‡ªå·±å‘å¸ƒçš„æ¨æ–‡ã€‚æ¨æ–‡å¿…é¡»æŒ‰ç…§æ—¶é—´é¡ºåºç”±æœ€è¿‘åˆ°æœ€è¿œæ’åºã€‚
- void follow(int followerId, int followeeId) ID ä¸º followerId çš„ç”¨æˆ·å¼€å§‹å…³æ³¨ ID ä¸º followeeId çš„ç”¨æˆ·ã€‚
- void unfollow(int followerId, int followeeId) ID ä¸º followerId çš„ç”¨æˆ·ä¸å†å…³æ³¨ ID ä¸º followeeId çš„ç”¨æˆ·ã€‚

---

## è§£é¢˜æ€è·¯
### é¢å‘å¯¹è±¡è®¾è®¡ + ä¼˜å…ˆé˜Ÿåˆ—

#### ğŸ“ æ ¸å¿ƒæ€æƒ³
1. ä½¿ç”¨é¢å‘å¯¹è±¡çš„è®¾è®¡æ€æƒ³ï¼Œåˆ›å»º User å’Œ Tweet ç±»æ¥ç®¡ç†ç”¨æˆ·å’Œæ¨æ–‡ä¿¡æ¯
2. æ¯ä¸ªç”¨æˆ·ç»´æŠ¤ä¸€ä¸ªæ¨æ–‡é“¾è¡¨å’Œå…³æ³¨è€…é›†åˆ
3. ä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆå¤§é¡¶å †ï¼‰æ¥åˆå¹¶å¤šä¸ªæ¨æ–‡é“¾è¡¨ï¼Œç¡®ä¿æŒ‰æ—¶é—´é¡ºåºè¿”å›æœ€æ–°çš„æ¨æ–‡

#### ğŸ› ï¸ å®ç°æ­¥éª¤
1. è®¾è®¡æ•°æ®ç»“æ„ï¼š
   - Tweet ç±»ï¼šå­˜å‚¨æ¨æ–‡ ID å’Œæ—¶é—´æˆ³
   - User ç±»ï¼šå­˜å‚¨ç”¨æˆ· IDã€å…³æ³¨åˆ—è¡¨å’Œæ¨æ–‡é“¾è¡¨
   - Twitter ç±»ï¼šä½¿ç”¨ HashMap å­˜å‚¨ç”¨æˆ·ä¿¡æ¯

2. å®ç°æ ¸å¿ƒåŠŸèƒ½ï¼š
   - postTweetï¼šåœ¨ç”¨æˆ·çš„æ¨æ–‡é“¾è¡¨å¤´éƒ¨æ’å…¥æ–°æ¨æ–‡
   - followï¼šå°†è¢«å…³æ³¨è€…çš„ ID åŠ å…¥ç”¨æˆ·çš„å…³æ³¨é›†åˆ
   - unfollowï¼šä»ç”¨æˆ·çš„å…³æ³¨é›†åˆä¸­ç§»é™¤è¢«å…³æ³¨è€…çš„ ID
   - getNewsFeedï¼šä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—åˆå¹¶æ‰€æœ‰å…³æ³¨è€…çš„æ¨æ–‡é“¾è¡¨

#### ğŸ§© ç¤ºä¾‹åˆ†æ
ä»¥ä¸‹æ˜¯ä¸€ä¸ªå…·ä½“çš„æ“ä½œåºåˆ—ç¤ºä¾‹ï¼š

1. åˆå§‹çŠ¶æ€ï¼š
```
ç”¨æˆ·æ˜ å°„è¡¨ï¼š{}
```

2. postTweet(1, 5)ï¼š
```
ç”¨æˆ· 1 çš„æ¨æ–‡é“¾è¡¨ï¼š5 -> null
ç”¨æˆ·æ˜ å°„è¡¨ï¼š{1: User(id=1, tweets=[5], followed=[1])}
```

3. getNewsFeed(1)ï¼š
```
ç”¨æˆ· 1 çš„å…³æ³¨åˆ—è¡¨ï¼š[1]
å¯è§æ¨æ–‡ï¼š[5]
è¿”å›ï¼š[5]
```

4. follow(1, 2)ï¼š
```
ç”¨æˆ· 1 çš„å…³æ³¨åˆ—è¡¨æ›´æ–°ï¼š[1, 2]
ç”¨æˆ·æ˜ å°„è¡¨ï¼š{
    1: User(id=1, tweets=[5], followed=[1, 2]),
    2: User(id=2, tweets=[], followed=[2])
}
```

5. postTweet(2, 6)ï¼š
```
ç”¨æˆ· 2 çš„æ¨æ–‡é“¾è¡¨ï¼š6 -> null
ç”¨æˆ·æ˜ å°„è¡¨ï¼š{
    1: User(id=1, tweets=[5], followed=[1, 2]),
    2: User(id=2, tweets=[6], followed=[2])
}
```

6. getNewsFeed(1)ï¼š
```
ç”¨æˆ· 1 çš„å…³æ³¨åˆ—è¡¨ï¼š[1, 2]
åˆå¹¶æ¨æ–‡ï¼š[6, 5]ï¼ˆæŒ‰æ—¶é—´æˆ³æ’åºï¼‰
è¿”å›ï¼š[6, 5]
```

7. unfollow(1, 2)ï¼š
```
ç”¨æˆ· 1 çš„å…³æ³¨åˆ—è¡¨æ›´æ–°ï¼š[1]
ç”¨æˆ·æ˜ å°„è¡¨ï¼š{
    1: User(id=1, tweets=[5], followed=[1]),
    2: User(id=2, tweets=[6], followed=[2])
}
```

8. getNewsFeed(1)ï¼š
```
ç”¨æˆ· 1 çš„å…³æ³¨åˆ—è¡¨ï¼š[1]
å¯è§æ¨æ–‡ï¼š[5]
è¿”å›ï¼š[5]
```

---

## ä»£ç å®ç°

å®Œæ•´çš„å¯è¿è¡Œä»£ç ï¼š[L0355_DesignTwitter.java](../src/main/java/L0355_DesignTwitter.java)

```java
public class L0355_DesignTwitter {
    // ç”¨äºç”Ÿæˆæ¨æ–‡æ—¶é—´æˆ³
    private static int timestamp = 0;
    
    // æ¨æ–‡ç±»ï¼ŒåŒ…å«æ¨æ–‡idå’Œå‘å¸ƒæ—¶é—´
    private class Tweet {
        private int id;
        private int time;
        private Tweet next;

        public Tweet(int id) {
            this.id = id;
            this.time = timestamp++;
            this.next = null;
        }
    }
    
    // ç”¨æˆ·ç±»ï¼ŒåŒ…å«ç”¨æˆ·å‘å¸ƒçš„æ¨æ–‡é“¾è¡¨å’Œå…³æ³¨é›†åˆ
    private class User {
        private int id;
        private Set<Integer> followed;
        private Tweet tweetHead;

        public User(int userId) {
            this.id = userId;
            this.followed = new HashSet<>();
            this.followed.add(userId); // ç”¨æˆ·é»˜è®¤å…³æ³¨è‡ªå·±
            this.tweetHead = null;
        }

        public void follow(int userId) {
            followed.add(userId);
        }

        public void unfollow(int userId) {
            // ä¸èƒ½å–å…³è‡ªå·±
            if (userId != this.id) {
                followed.remove(userId);
            }
        }

        public void post(int tweetId) {
            Tweet tweet = new Tweet(tweetId);
            tweet.next = tweetHead;
            tweetHead = tweet;
        }
    }
    
    // ç”¨æˆ·æ˜ å°„è¡¨
    private Map<Integer, User> userMap;
    
    public L0355_DesignTwitter() {
        userMap = new HashMap<>();
    }
    
    public void postTweet(int userId, int tweetId) {
        // å¦‚æœç”¨æˆ·ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°ç”¨æˆ·
        if (!userMap.containsKey(userId)) {
            userMap.put(userId, new User(userId));
        }
        userMap.get(userId).post(tweetId);
    }
    
    public List<Integer> getNewsFeed(int userId) {
        List<Integer> result = new ArrayList<>();
        if (!userMap.containsKey(userId)) {
            return result;
        }
        
        // è·å–è¯¥ç”¨æˆ·å…³æ³¨çš„æ‰€æœ‰ç”¨æˆ·
        Set<Integer> users = userMap.get(userId).followed;
        
        // ä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—åˆå¹¶å¤šä¸ªé“¾è¡¨ï¼ŒæŒ‰ç…§æ—¶é—´æˆ³æ’åº
        PriorityQueue<Tweet> pq = new PriorityQueue<>((a, b) -> b.time - a.time);
        
        // å°†æ‰€æœ‰å…³æ³¨ç”¨æˆ·çš„æœ€æ–°æ¨æ–‡åŠ å…¥ä¼˜å…ˆé˜Ÿåˆ—
        for (int user : users) {
            Tweet tweet = userMap.get(user).tweetHead;
            if (tweet != null) {
                pq.offer(tweet);
            }
        }
        
        // è·å–å‰ 10 æ¡æ¨æ–‡
        while (!pq.isEmpty() && result.size() < 10) {
            Tweet tweet = pq.poll();
            result.add(tweet.id);
            if (tweet.next != null) {
                pq.offer(tweet.next);
            }
        }
        
        return result;
    }
    
    public void follow(int followerId, int followeeId) {
        // å¦‚æœç”¨æˆ·ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°ç”¨æˆ·
        if (!userMap.containsKey(followerId)) {
            userMap.put(followerId, new User(followerId));
        }
        if (!userMap.containsKey(followeeId)) {
            userMap.put(followeeId, new User(followeeId));
        }
        userMap.get(followerId).follow(followeeId);
    }
    
    public void unfollow(int followerId, int followeeId) {
        if (userMap.containsKey(followerId)) {
            userMap.get(followerId).unfollow(followeeId);
        }
    }
}
```

---

## å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š
  - postTweetï¼šO(1)
    - åœ¨é“¾è¡¨å¤´éƒ¨æ’å…¥æ–°æ¨æ–‡
  - followï¼šO(1)
    - åœ¨ HashSet ä¸­æ·»åŠ å…³æ³¨è€… ID
  - unfollowï¼šO(1)
    - åœ¨ HashSet ä¸­ç§»é™¤å…³æ³¨è€… ID
  - getNewsFeedï¼šO(N log N)
    - N æ˜¯å…³æ³¨çš„ç”¨æˆ·æ•°é‡
    - ä¼˜å…ˆé˜Ÿåˆ—çš„æ“ä½œæ—¶é—´å¤æ‚åº¦æ˜¯ O(log N)
    - éœ€è¦å¤„ç†æ‰€æœ‰å…³æ³¨ç”¨æˆ·çš„æ¨æ–‡

- **ç©ºé—´å¤æ‚åº¦**ï¼šO(U + T)
  - U æ˜¯ç”¨æˆ·æ€»æ•°
  - T æ˜¯æ‰€æœ‰ç”¨æˆ·å‘å¸ƒçš„æ¨æ–‡æ€»æ•°
  - æ¯ä¸ªç”¨æˆ·éœ€è¦å­˜å‚¨å…³æ³¨åˆ—è¡¨å’Œæ¨æ–‡é“¾è¡¨

---

## LeetCode é¢˜è§£

æœ¬é¢˜è§£æ˜¯ LeetCode ç³»åˆ—é¢˜è§£çš„ä¸€éƒ¨åˆ†ã€‚è¯¥ç³»åˆ—é¢˜è§£è‡´åŠ›äºå¸®åŠ©ç¨‹åºå‘˜æ›´å¥½åœ°ç†è§£å’ŒæŒæ¡ç®—æ³•æ€ç»´ï¼Œå†…å®¹åŒ…å«è¯¦ç»†çš„è§£é¢˜æ€è·¯åˆ†æã€å›¾æ–‡å¹¶èŒ‚çš„ç¤ºä¾‹è®²è§£å’Œå®Œæ•´çš„ä»£ç å®ç°ã€‚

<img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="GitHub" width="20" style="vertical-align: middle; margin-right: 5px"> [LeetCode æœ€å…¨é¢˜è§£](https://github.com/LjyYano/LeetCode)ï¼šæŒç»­æ›´æ–°ä¸­ï¼Œæ¬¢è¿ Star â­ï¸ å…³æ³¨ï¼Œä¸€èµ·æ¢è®¨ç®—æ³•ä¹‹ç¾ã€‚ 