---
title: Nim 游戏
date: 2024-03-24
---

## 题目描述

**🔗 题目**：[Nim 游戏](https://leetcode.cn/problems/nim-game/)  
**🏷️ 标签**：`数学` `博弈`  
**🟢 难度**：`简单`  

你和你的朋友，两个人一起玩 Nim 游戏：

- 桌子上有一堆石头。
- 你们轮流进行自己的回合， 你作为先手 。
- 每一回合，轮到的人拿掉 1 - 3 块石头。
- 拿掉最后一块石头的人就是获胜者。

假设你们每一步都是最优解。请编写一个函数，来判断你是否可以在给定石头数量为 n 的情况下赢得游戏。如果可以赢，返回 true；否则，返回 false 。

**示例 1：**
```
输入：n = 4
输出：false 
解释：以下是可能的结果:
1. 你移除 1 颗石头。你的朋友移除了 3 颗石头，包括最后一颗。你的朋友赢了。
2. 你移除 2 颗石头。你的朋友移除了 2 颗石头，包括最后一颗。你的朋友赢了。
3. 你移除 3 颗石头。你的朋友移除了 1 颗石头，包括最后一颗。你的朋友赢了。
在所有结果中，你的朋友都赢了。
```

**示例 2：**
```
输入：n = 1
输出：true
```

**示例 3：**
```
输入：n = 2
输出：true
```

**提示：**
- 1 <= n <= 2³¹ - 1

---

## 解题思路
### 数学归纳

#### 📝 核心思想
这是一个经典的博弈论问题。通过分析小规模的情况，我们可以发现一个重要的规律：当石头数量是 4 的倍数时，先手必输；否则先手必胜。

这个结论可以通过数学归纳法证明：
1. 当 n = 4 时，无论先手如何选择（1、2 或 3 颗），后手都可以选择剩余的石头，使得后手获胜。
2. 当 n > 4 时，如果 n 不是 4 的倍数，先手可以通过拿取适当数量的石头，使得剩余的石头数量是 4 的倍数，从而将必败态转嫁给对手。

#### 🛠️ 实现步骤
1. 判断输入的石头数量 n 是否是 4 的倍数
2. 如果是 4 的倍数，返回 false（先手必输）
3. 如果不是 4 的倍数，返回 true（先手必胜）

#### 🧩 示例分析
让我们分析不同石头数量的情况：

| 石头数量 n | 先手策略 | 剩余石头 | 结果 | 原因 |
|-----------|---------|---------|------|------|
| 1 | 拿 1 颗 | 0 | 先手胜 | 直接拿走最后一颗 |
| 2 | 拿 2 颗 | 0 | 先手胜 | 直接拿走所有石头 |
| 3 | 拿 3 颗 | 0 | 先手胜 | 直接拿走所有石头 |
| 4 | 任意选择 | 1-3 | 先手负 | 对手可以一次拿完 |
| 5 | 拿 1 颗 | 4 | 先手胜 | 留给对手必败态 |
| 6 | 拿 2 颗 | 4 | 先手胜 | 留给对手必败态 |
| 7 | 拿 3 颗 | 4 | 先手胜 | 留给对手必败态 |
| 8 | 任意选择 | 5-7 | 先手负 | 对手可以转化为必败态 |

从上面的分析可以看出：
1. 当 n = 4k（k 为自然数）时，无论先手如何选择，对手都可以通过合适的选择将局面转化为 4 的倍数，最终获胜。
2. 当 n ≠ 4k 时，先手可以通过拿取适当数量的石头，使剩余石头数量为 4 的倍数，从而将必败态转嫁给对手。

---

## 代码实现

完整的可运行代码：[L0292_NimGame.java](../src/main/java/L0292_NimGame.java)

```java
public boolean canWinNim(int n) {
    // 如果石头数量是 4 的倍数，先手必输
    // 否则先手必胜
    return n % 4 != 0;
}
```

---

## 复杂度分析

- **时间复杂度**：O(1)，只需要进行一次取模运算。
- **空间复杂度**：O(1)，只使用了常数额外空间。

---

## LeetCode 题解

本题解是 LeetCode 系列题解的一部分。该系列题解致力于帮助程序员更好地理解和掌握算法思维，内容包含详细的解题思路分析、图文并茂的示例讲解和完整的代码实现。

<img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="GitHub" width="20" style="vertical-align: middle; margin-right: 5px"> [LeetCode 最全题解](https://github.com/LjyYano/LeetCode)：持续更新中，欢迎 Star ⭐️ 关注，一起探讨算法之美。 