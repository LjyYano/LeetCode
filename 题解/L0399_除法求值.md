---
title: é™¤æ³•æ±‚å€¼
date: 2025-02-11
---

## é¢˜ç›®æè¿°

**ğŸ”— é¢˜ç›®**ï¼š[399. é™¤æ³•æ±‚å€¼](https://leetcode.cn/problems/evaluate-division/)  
**ğŸ·ï¸ æ ‡ç­¾**ï¼š`æ·±åº¦ä¼˜å…ˆæœç´¢` `å¹¿åº¦ä¼˜å…ˆæœç´¢` `å¹¶æŸ¥é›†` `å›¾` `æ•°ç»„` `æœ€çŸ­è·¯`  
**ğŸŸ¡ éš¾åº¦**ï¼š`ä¸­ç­‰`  

ç»™ä½ ä¸€ä¸ªå˜é‡å¯¹æ•°ç»„ equations å’Œä¸€ä¸ªå®æ•°å€¼æ•°ç»„ values ä½œä¸ºå·²çŸ¥æ¡ä»¶ï¼Œå…¶ä¸­ equations[i] = [Ai, Bi] å’Œ values[i] å…±åŒè¡¨ç¤ºç­‰å¼ Ai / Bi = values[i] ã€‚æ¯ä¸ª Ai æˆ– Bi æ˜¯ä¸€ä¸ªè¡¨ç¤ºå•ä¸ªå˜é‡çš„å­—ç¬¦ä¸²ã€‚

å¦æœ‰ä¸€äº›ä»¥æ•°ç»„ queries è¡¨ç¤ºçš„é—®é¢˜ï¼Œå…¶ä¸­ queries[j] = [Cj, Dj] è¡¨ç¤ºç¬¬ j ä¸ªé—®é¢˜ï¼Œè¯·ä½ æ ¹æ®å·²çŸ¥æ¡ä»¶æ‰¾å‡º Cj / Dj = ? çš„ç»“æœä½œä¸ºç­”æ¡ˆã€‚

è¿”å› æ‰€æœ‰é—®é¢˜çš„ç­”æ¡ˆ ã€‚å¦‚æœå­˜åœ¨æŸä¸ªæ— æ³•ç¡®å®šçš„ç­”æ¡ˆï¼Œåˆ™ç”¨ -1.0 æ›¿ä»£è¿™ä¸ªç­”æ¡ˆã€‚å¦‚æœé—®é¢˜ä¸­å‡ºç°äº†ç»™å®šçš„å·²çŸ¥æ¡ä»¶ä¸­æ²¡æœ‰å‡ºç°çš„å­—ç¬¦ä¸²ï¼Œä¹Ÿéœ€è¦ç”¨ -1.0 æ›¿ä»£è¿™ä¸ªç­”æ¡ˆã€‚

æ³¨æ„ï¼šè¾“å…¥æ€»æ˜¯æœ‰æ•ˆçš„ã€‚ä½ å¯ä»¥å‡è®¾é™¤æ³•è¿ç®—ä¸­ä¸ä¼šå‡ºç°é™¤æ•°ä¸º 0 çš„æƒ…å†µï¼Œä¸”ä¸å­˜åœ¨ä»»ä½•çŸ›ç›¾çš„ç»“æœã€‚

ç¤ºä¾‹ 1ï¼š
```
è¾“å…¥ï¼šequations = [["a","b"],["b","c"]], values = [2.0,3.0], queries = [["a","c"],["b","a"],["a","e"],["a","a"],["x","x"]]
è¾“å‡ºï¼š[6.00000,0.50000,-1.00000,1.00000,-1.00000]
è§£é‡Šï¼š
æ¡ä»¶ï¼ša / b = 2.0, b / c = 3.0
é—®é¢˜ï¼ša / c = ?, b / a = ?, a / e = ?, a / a = ?, x / x = ?
ç»“æœï¼š[6.0, 0.5, -1.0, 1.0, -1.0 ]
```

ç¤ºä¾‹ 2ï¼š
```
è¾“å…¥ï¼šequations = [["a","b"],["b","c"],["bc","cd"]], values = [1.5,2.5,5.0], queries = [["a","c"],["c","b"],["bc","cd"],["cd","bc"]]
è¾“å‡ºï¼š[3.75000,0.40000,5.00000,0.20000]
```

ç¤ºä¾‹ 3ï¼š
```
è¾“å…¥ï¼šequations = [["a","b"]], values = [0.5], queries = [["a","b"],["b","a"],["a","c"],["x","y"]]
è¾“å‡ºï¼š[0.50000,2.00000,-1.00000,-1.00000]
```

æç¤ºï¼š
- 1 <= equations.length <= 20
- equations[i].length == 2
- 1 <= Ai.length, Bi.length <= 5
- values.length == equations.length
- 0.0 < values[i] <= 20.0
- 1 <= queries.length <= 20
- queries[i].length == 2
- 1 <= Cj.length, Dj.length <= 5
- Ai, Bi, Cj, Dj ç”±å°å†™è‹±æ–‡å­—æ¯ä¸æ•°å­—ç»„æˆ

---

## è§£é¢˜æ€è·¯
### å¸¦æƒå¹¶æŸ¥é›†

#### ğŸ“ æ ¸å¿ƒæ€æƒ³
è¿™é“é¢˜å¯ä»¥ä½¿ç”¨å¸¦æƒå¹¶æŸ¥é›†æ¥è§£å†³ã€‚æˆ‘ä»¬å¯ä»¥å°†é™¤æ³•å…³ç³»çœ‹ä½œæ˜¯æœ‰å‘å›¾ä¸­çš„è¾¹ï¼Œè¾¹çš„æƒé‡å°±æ˜¯é™¤æ³•çš„ç»“æœã€‚ä¾‹å¦‚ï¼Œå¦‚æœ a/b = 2ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä½œæ˜¯ä» a åˆ° b æœ‰ä¸€æ¡æƒé‡ä¸º 2 çš„è¾¹ã€‚

å…³é”®æ€è·¯ï¼š
1. ä½¿ç”¨å¹¶æŸ¥é›†ç»´æŠ¤èŠ‚ç‚¹ä¹‹é—´çš„å…³ç³»
2. åœ¨å¹¶æŸ¥é›†ä¸­å­˜å‚¨æ¯ä¸ªèŠ‚ç‚¹åˆ°å…¶çˆ¶èŠ‚ç‚¹çš„æƒé‡ï¼ˆé™¤æ³•ç»“æœï¼‰
3. é€šè¿‡è·¯å¾„å‹ç¼©ä¼˜åŒ–æŸ¥æ‰¾æ“ä½œï¼ŒåŒæ—¶æ›´æ–°æƒé‡

#### ğŸ› ï¸ å®ç°æ­¥éª¤
1. è®¾è®¡å¹¶æŸ¥é›†æ•°æ®ç»“æ„ï¼š
   - ä½¿ç”¨ Map å­˜å‚¨çˆ¶èŠ‚ç‚¹å…³ç³»
   - ä½¿ç”¨ Map å­˜å‚¨èŠ‚ç‚¹åˆ°çˆ¶èŠ‚ç‚¹çš„æƒé‡

2. å®ç°åŸºæœ¬æ“ä½œï¼š
   - addï¼šæ·»åŠ æ–°èŠ‚ç‚¹
   - findï¼šæŸ¥æ‰¾çˆ¶èŠ‚ç‚¹å¹¶è¿›è¡Œè·¯å¾„å‹ç¼©
   - unionï¼šåˆå¹¶ä¸¤ä¸ªèŠ‚ç‚¹
   - calculateï¼šè®¡ç®—ä¸¤ä¸ªèŠ‚ç‚¹çš„é™¤æ³•ç»“æœ

3. å¤„ç†è¾“å…¥ï¼š
   - éå† equations å’Œ values æ„å»ºå¹¶æŸ¥é›†
   - éå† queries è®¡ç®—ç»“æœ

#### ğŸ§© ç¤ºä¾‹åˆ†æ
ä»¥ç¤ºä¾‹ 1 ä¸ºä¾‹ï¼Œequations = [["a","b"],["b","c"]], values = [2.0,3.0]ï¼š

1. åˆå§‹çŠ¶æ€ï¼š
```
æ¯ä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹æ˜¯è‡ªå·±ï¼Œæƒé‡ä¸º 1.0
a -> a (1.0)
b -> b (1.0)
c -> c (1.0)
```

2. å¤„ç† a/b = 2.0ï¼š
```
å°† a çš„çˆ¶èŠ‚ç‚¹è®¾ä¸º bï¼Œæƒé‡ä¸º 2.0
a -> b (2.0)
b -> b (1.0)
c -> c (1.0)
```

3. å¤„ç† b/c = 3.0ï¼š
```
å°† b çš„çˆ¶èŠ‚ç‚¹è®¾ä¸º cï¼Œæƒé‡ä¸º 3.0
a -> b (2.0)
b -> c (3.0)
c -> c (1.0)
```

4. è®¡ç®— a/cï¼š
```
a åˆ°æ ¹èŠ‚ç‚¹çš„è·¯å¾„ï¼ša -> b -> c
æƒé‡è®¡ç®—ï¼š2.0 * 3.0 = 6.0
```

è·¯å¾„å‹ç¼©åï¼š
```
a -> c (6.0)
b -> c (3.0)
c -> c (1.0)
```

---

## ä»£ç å®ç°

å®Œæ•´çš„å¯è¿è¡Œä»£ç ï¼š[L0399_EvaluateDivision.java](../src/main/java/L0399_EvaluateDivision.java)

```java
class UnionFind {
    private Map<String, String> parent;  // å­˜å‚¨èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹
    private Map<String, Double> weight;  // å­˜å‚¨èŠ‚ç‚¹åˆ°çˆ¶èŠ‚ç‚¹çš„æƒé‡ï¼ˆé™¤æ³•ç»“æœï¼‰
    
    public UnionFind() {
        parent = new HashMap<>();
        weight = new HashMap<>();
    }
    
    // æ·»åŠ æ–°èŠ‚ç‚¹
    public void add(String x) {
        if (!parent.containsKey(x)) {
            parent.put(x, x);
            weight.put(x, 1.0);
        }
    }
    
    // æŸ¥æ‰¾çˆ¶èŠ‚ç‚¹å¹¶è¿›è¡Œè·¯å¾„å‹ç¼©
    public String find(String x) {
        if (!parent.containsKey(x)) {
            return null;
        }
        
        // è·¯å¾„å‹ç¼©ï¼Œæ›´æ–°æƒé‡
        if (!x.equals(parent.get(x))) {
            String oldParent = parent.get(x);
            String newParent = find(oldParent);
            parent.put(x, newParent);
            weight.put(x, weight.get(x) * weight.get(oldParent));
        }
        
        return parent.get(x);
    }
    
    // åˆå¹¶ä¸¤ä¸ªèŠ‚ç‚¹
    public void union(String x, String y, double value) {
        add(x);
        add(y);
        String rootX = find(x);
        String rootY = find(y);
        
        if (!rootX.equals(rootY)) {
            parent.put(rootX, rootY);
            // æ›´æ–°æƒé‡
            weight.put(rootX, value * weight.get(y) / weight.get(x));
        }
    }
    
    // è®¡ç®—ä¸¤ä¸ªèŠ‚ç‚¹çš„é™¤æ³•ç»“æœ
    public double calculate(String x, String y) {
        String rootX = find(x);
        String rootY = find(y);
        
        if (rootX == null || rootY == null || !rootX.equals(rootY)) {
            return -1.0;
        }
        
        return weight.get(x) / weight.get(y);
    }
}
```

---

## å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š
  - æ„å»ºå¹¶æŸ¥é›†ï¼šO(N)ï¼Œå…¶ä¸­ N æ˜¯ equations çš„é•¿åº¦
  - æ¯æ¬¡æŸ¥è¯¢ï¼šO(1)ï¼ˆå¹³å‡ï¼‰ï¼Œè·¯å¾„å‹ç¼©åå‡ ä¹æ˜¯å¸¸æ•°æ—¶é—´
  - æ€»ä½“ï¼šO(N + Q)ï¼Œå…¶ä¸­ Q æ˜¯æŸ¥è¯¢çš„æ•°é‡

- **ç©ºé—´å¤æ‚åº¦**ï¼šO(N)
  - éœ€è¦å­˜å‚¨æ¯ä¸ªå˜é‡çš„çˆ¶èŠ‚ç‚¹å’Œæƒé‡
  - è·¯å¾„å‹ç¼©å¯ä»¥ä¼˜åŒ–æŸ¥è¯¢æ—¶é—´ï¼Œä½†ä¸ä¼šå‡å°‘ç©ºé—´ä½¿ç”¨

---

## å…¶ä»–è§£æ³•

1. **æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰**
   - å°†é—®é¢˜å»ºæ¨¡ä¸ºå›¾ï¼Œæ¯ä¸ªå˜é‡æ˜¯èŠ‚ç‚¹ï¼Œé™¤æ³•å…³ç³»æ˜¯è¾¹
   - å¯¹æ¯ä¸ªæŸ¥è¯¢ä½¿ç”¨ DFS å¯»æ‰¾è·¯å¾„
   - æ—¶é—´å¤æ‚åº¦è¾ƒé«˜ï¼Œä½†å®ç°ç®€å•

2. **Floyd ç®—æ³•**
   - å°†é—®é¢˜è½¬åŒ–ä¸ºæœ€çŸ­è·¯å¾„é—®é¢˜
   - é¢„å¤„ç†æ‰€æœ‰ç‚¹å¯¹ä¹‹é—´çš„é™¤æ³•ç»“æœ
   - é€‚åˆæŸ¥è¯¢æ¬¡æ•°å¤šçš„æƒ…å†µ

3. **å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰**
   - ç±»ä¼¼ DFSï¼Œä½†ä½¿ç”¨ BFS å¯»æ‰¾è·¯å¾„
   - å¯ä»¥æ‰¾åˆ°æœ€çŸ­è·¯å¾„
   - å®ç°ç›¸å¯¹å¤æ‚

é€‰æ‹©å»ºè®®ï¼š
- å¦‚æœæŸ¥è¯¢æ¬¡æ•°è¾ƒå¤šï¼Œä½¿ç”¨å¹¶æŸ¥é›†æˆ– Floyd ç®—æ³•
- å¦‚æœå›¾è¾ƒç¨€ç–ï¼Œå¯ä»¥è€ƒè™‘ DFS æˆ– BFS
- å¦‚æœéœ€è¦æœ€ä¼˜çš„æ—¶é—´å¤æ‚åº¦ï¼Œä½¿ç”¨å¹¶æŸ¥é›†

---

## LeetCode é¢˜è§£

æœ¬é¢˜è§£æ˜¯ LeetCode ç³»åˆ—é¢˜è§£çš„ä¸€éƒ¨åˆ†ã€‚è¯¥ç³»åˆ—é¢˜è§£è‡´åŠ›äºå¸®åŠ©ç¨‹åºå‘˜æ›´å¥½åœ°ç†è§£å’ŒæŒæ¡ç®—æ³•æ€ç»´ï¼Œå†…å®¹åŒ…å«è¯¦ç»†çš„è§£é¢˜æ€è·¯åˆ†æã€å›¾æ–‡å¹¶èŒ‚çš„ç¤ºä¾‹è®²è§£å’Œå®Œæ•´çš„ä»£ç å®ç°ã€‚

<img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="GitHub" width="20" style="vertical-align: middle; margin-right: 5px"> [LeetCode æœ€å…¨é¢˜è§£](https://github.com/LjyYano/LeetCode)ï¼šæŒç»­æ›´æ–°ä¸­ï¼Œæ¬¢è¿ Star â­ï¸ å…³æ³¨ï¼Œä¸€èµ·æ¢è®¨ç®—æ³•ä¹‹ç¾ã€‚ 