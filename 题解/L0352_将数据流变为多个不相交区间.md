---
title: å°†æ•°æ®æµå˜ä¸ºå¤šä¸ªä¸ç›¸äº¤åŒºé—´
date: 2025-02-11
---

## é¢˜ç›®æè¿°

**ğŸ”— é¢˜ç›®**ï¼š[å°†æ•°æ®æµå˜ä¸ºå¤šä¸ªä¸ç›¸äº¤åŒºé—´](https://leetcode.cn/problems/data-stream-as-disjoint-intervals/)  
**ğŸ·ï¸ æ ‡ç­¾**ï¼š`è®¾è®¡` `äºŒåˆ†æŸ¥æ‰¾` `æœ‰åºé›†åˆ`  
**ğŸ”´ éš¾åº¦**ï¼š`å›°éš¾`  

ç»™ä½ ä¸€ä¸ªæ•°æ®æµã€‚ä½ éœ€è¦å®ç°ä¸€ä¸ªæ•°æ®ç»“æ„æ”¯æŒä¸¤ä¸ªæ“ä½œï¼š

1. addNum(val) - å‘æ•°æ®æµä¸­åŠ å…¥æ•´æ•° val
2. getIntervals() - è¿”å›æ•°æ®æµä¸­å·²æœ‰çš„æ•°å­—çš„æ‰€æœ‰ä¸ç›¸äº¤åŒºé—´

å®ç° SummaryRanges ç±»ï¼š
- SummaryRanges() ä½¿ç”¨ç©ºæ•°æ®æµåˆå§‹åŒ–å¯¹è±¡
- void addNum(int val) å‘æ•°æ®æµä¸­åŠ å…¥æ•´æ•° val
- int[][] getIntervals() ä»¥ä¸ç›¸äº¤åŒºé—´ [starti, endi] çš„åˆ—è¡¨å½¢å¼è¿”å›å¯¹æ•°æ®æµä¸­æ•´æ•°çš„æ€»ç»“

ç¤ºä¾‹ï¼š
```
è¾“å…¥ï¼š
["SummaryRanges", "addNum", "getIntervals", "addNum", "getIntervals", "addNum", "getIntervals", "addNum", "getIntervals", "addNum", "getIntervals"]
[[], [1], [], [3], [], [7], [], [2], [], [6], []]
è¾“å‡ºï¼š
[null, null, [[1, 1]], null, [[1, 1], [3, 3]], null, [[1, 1], [3, 3], [7, 7]], null, [[1, 3], [7, 7]], null, [[1, 3], [6, 7]]]

è§£é‡Šï¼š
SummaryRanges summaryRanges = new SummaryRanges();
summaryRanges.addNum(1);      // arr = [1]
summaryRanges.getIntervals(); // è¿”å› [[1, 1]]
summaryRanges.addNum(3);      // arr = [1, 3]
summaryRanges.getIntervals(); // è¿”å› [[1, 1], [3, 3]]
summaryRanges.addNum(7);      // arr = [1, 3, 7]
summaryRanges.getIntervals(); // è¿”å› [[1, 1], [3, 3], [7, 7]]
summaryRanges.addNum(2);      // arr = [1, 2, 3, 7]
summaryRanges.getIntervals(); // è¿”å› [[1, 3], [7, 7]]
summaryRanges.addNum(6);      // arr = [1, 2, 3, 6, 7]
summaryRanges.getIntervals(); // è¿”å› [[1, 3], [6, 7]]
```

æç¤ºï¼š
- 0 <= val <= 10â´
- æœ€å¤šè°ƒç”¨ addNum å’Œ getIntervals æ–¹æ³• 3 * 10â´ æ¬¡

---

## è§£é¢˜æ€è·¯
### TreeMap åŒºé—´åˆå¹¶

#### ğŸ“ æ ¸å¿ƒæ€æƒ³
1. ä½¿ç”¨ TreeMap å­˜å‚¨åŒºé—´ä¿¡æ¯ï¼Œå…¶ä¸­ï¼š
   - key è¡¨ç¤ºåŒºé—´çš„èµ·ç‚¹
   - value è¡¨ç¤ºåŒºé—´çš„ç»ˆç‚¹
2. æ¯æ¬¡æ·»åŠ æ–°æ•°å­—æ—¶ï¼Œéœ€è¦è€ƒè™‘ä¸ç°æœ‰åŒºé—´çš„åˆå¹¶æƒ…å†µï¼š
   - æ˜¯å¦åœ¨æŸä¸ªåŒºé—´å†…
   - æ˜¯å¦å¯ä»¥ä¸å‰ä¸€ä¸ªåŒºé—´åˆå¹¶
   - æ˜¯å¦å¯ä»¥ä¸åä¸€ä¸ªåŒºé—´åˆå¹¶
   - æ˜¯å¦éœ€è¦åˆ›å»ºæ–°åŒºé—´

#### ğŸ› ï¸ å®ç°æ­¥éª¤
1. åˆå§‹åŒ–ï¼š
   - åˆ›å»ºç©ºçš„ TreeMap å­˜å‚¨åŒºé—´ä¿¡æ¯

2. æ·»åŠ æ•°å­—ï¼ˆaddNum æ–¹æ³•ï¼‰ï¼š
   - è·å–å°äºç­‰äºå½“å‰å€¼çš„æœ€å¤§é”®ï¼ˆfloorKeyï¼‰
   - è·å–å¤§äºå½“å‰å€¼çš„æœ€å°é”®ï¼ˆceilingKeyï¼‰
   - åˆ¤æ–­æ˜¯å¦åœ¨ç°æœ‰åŒºé—´å†…
   - åˆ¤æ–­æ˜¯å¦å¯ä»¥ä¸å‰ååŒºé—´åˆå¹¶
   - æ ¹æ®åˆ¤æ–­ç»“æœè¿›è¡Œç›¸åº”çš„åŒºé—´åˆå¹¶æˆ–åˆ›å»ºæ–°åŒºé—´

3. è·å–åŒºé—´ï¼ˆgetIntervals æ–¹æ³•ï¼‰ï¼š
   - éå† TreeMap
   - å°†æ¯ä¸ªåŒºé—´è½¬æ¢ä¸ºæ•°ç»„å½¢å¼
   - è¿”å›æ‰€æœ‰åŒºé—´çš„åˆ—è¡¨

#### ğŸ§© ç¤ºä¾‹åˆ†æ
ä»¥ç¤ºä¾‹è¾“å…¥åºåˆ—ä¸ºä¾‹ï¼Œåˆ†ææ¯ä¸€æ­¥çš„æ“ä½œï¼š

1. æ·»åŠ  1ï¼š
```
å½“å‰å€¼ï¼š1
ç°æœ‰åŒºé—´ï¼š{}
æ“ä½œï¼šåˆ›å»ºæ–°åŒºé—´ [1,1]
ç»“æœï¼š[[1,1]]
```

2. æ·»åŠ  3ï¼š
```
å½“å‰å€¼ï¼š3
ç°æœ‰åŒºé—´ï¼š[[1,1]]
æ“ä½œï¼šåˆ›å»ºæ–°åŒºé—´ [3,3]
ç»“æœï¼š[[1,1], [3,3]]
```

3. æ·»åŠ  7ï¼š
```
å½“å‰å€¼ï¼š7
ç°æœ‰åŒºé—´ï¼š[[1,1], [3,3]]
æ“ä½œï¼šåˆ›å»ºæ–°åŒºé—´ [7,7]
ç»“æœï¼š[[1,1], [3,3], [7,7]]
```

4. æ·»åŠ  2ï¼š
```
å½“å‰å€¼ï¼š2
ç°æœ‰åŒºé—´ï¼š[[1,1], [3,3], [7,7]]
æ“ä½œï¼šåˆå¹¶åŒºé—´ [1,1] å’Œ [3,3]
ç»“æœï¼š[[1,3], [7,7]]
```

5. æ·»åŠ  6ï¼š
```
å½“å‰å€¼ï¼š6
ç°æœ‰åŒºé—´ï¼š[[1,3], [7,7]]
æ“ä½œï¼šåˆ›å»ºæ–°åŒºé—´ [6,6] å¹¶ä¸ [7,7] åˆå¹¶
ç»“æœï¼š[[1,3], [6,7]]
```

---

## ä»£ç å®ç°

å®Œæ•´çš„å¯è¿è¡Œä»£ç ï¼š[L0352_DataStreamAsDisjointIntervals.java](../src/main/java/L0352_DataStreamAsDisjointIntervals.java)

```java
public class L0352_DataStreamAsDisjointIntervals {
    // ä½¿ç”¨ TreeMap å­˜å‚¨åŒºé—´çš„èµ·ç‚¹å’Œç»ˆç‚¹
    TreeMap<Integer, Integer> intervals;

    public L0352_DataStreamAsDisjointIntervals() {
        intervals = new TreeMap<>();
    }
    
    public void addNum(int val) {
        // è·å–å°äºç­‰äº val çš„æœ€å¤§é”®
        Integer start = intervals.floorKey(val);
        // è·å–å¤§äº val çš„æœ€å°é”®
        Integer end = intervals.ceilingKey(val);
        
        // å¦‚æœå½“å‰å€¼å·²ç»åœ¨æŸä¸ªåŒºé—´å†…ï¼Œç›´æ¥è¿”å›
        if (start != null && intervals.get(start) >= val) {
            return;
        }
        
        // æ˜¯å¦å¯ä»¥ä¸å‰ä¸€ä¸ªåŒºé—´åˆå¹¶
        boolean mergeWithPrev = start != null && intervals.get(start) + 1 == val;
        // æ˜¯å¦å¯ä»¥ä¸åä¸€ä¸ªåŒºé—´åˆå¹¶
        boolean mergeWithNext = end != null && val + 1 == end;
        
        if (mergeWithPrev && mergeWithNext) {
            // ä¸å‰ååŒºé—´éƒ½å¯ä»¥åˆå¹¶
            intervals.put(start, intervals.get(end));
            intervals.remove(end);
        } else if (mergeWithPrev) {
            // åªä¸å‰ä¸€ä¸ªåŒºé—´åˆå¹¶
            intervals.put(start, val);
        } else if (mergeWithNext) {
            // åªä¸åä¸€ä¸ªåŒºé—´åˆå¹¶
            intervals.put(val, intervals.get(end));
            intervals.remove(end);
        } else {
            // æ— æ³•åˆå¹¶ï¼Œåˆ›å»ºæ–°åŒºé—´
            intervals.put(val, val);
        }
    }
    
    public int[][] getIntervals() {
        List<int[]> result = new ArrayList<>();
        for (Integer start : intervals.keySet()) {
            result.add(new int[]{start, intervals.get(start)});
        }
        return result.toArray(new int[result.size()][]);
    }
}
```

---

## å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š
  - addNum æ–¹æ³•ï¼šO(log n)ï¼Œå…¶ä¸­ n æ˜¯å½“å‰åŒºé—´çš„æ•°é‡
    - TreeMap çš„ floorKey å’Œ ceilingKey æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸º O(log n)
    - åŒºé—´åˆå¹¶å’Œæ’å…¥æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¹Ÿæ˜¯ O(log n)
  - getIntervals æ–¹æ³•ï¼šO(n)ï¼Œéœ€è¦éå†æ‰€æœ‰åŒºé—´

- **ç©ºé—´å¤æ‚åº¦**ï¼šO(n)
  - TreeMap å­˜å‚¨æ‰€æœ‰åŒºé—´ä¿¡æ¯ï¼Œæœ€åæƒ…å†µä¸‹éœ€è¦å­˜å‚¨ n ä¸ªä¸ç›¸è¿çš„åŒºé—´
  - getIntervals æ–¹æ³•éœ€è¦åˆ›å»ºä¸€ä¸ªæ•°ç»„æ¥å­˜å‚¨æ‰€æœ‰åŒºé—´

---

## LeetCode é¢˜è§£

æœ¬é¢˜è§£æ˜¯ LeetCode ç³»åˆ—é¢˜è§£çš„ä¸€éƒ¨åˆ†ã€‚è¯¥ç³»åˆ—é¢˜è§£è‡´åŠ›äºå¸®åŠ©ç¨‹åºå‘˜æ›´å¥½åœ°ç†è§£å’ŒæŒæ¡ç®—æ³•æ€ç»´ï¼Œå†…å®¹åŒ…å«è¯¦ç»†çš„è§£é¢˜æ€è·¯åˆ†æã€å›¾æ–‡å¹¶èŒ‚çš„ç¤ºä¾‹è®²è§£å’Œå®Œæ•´çš„ä»£ç å®ç°ã€‚

<img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="GitHub" width="20" style="vertical-align: middle; margin-right: 5px"> [LeetCode æœ€å…¨é¢˜è§£](https://github.com/LjyYano/LeetCode)ï¼šæŒç»­æ›´æ–°ä¸­ï¼Œæ¬¢è¿ Star â­ï¸ å…³æ³¨ï¼Œä¸€èµ·æ¢è®¨ç®—æ³•ä¹‹ç¾ã€‚ 