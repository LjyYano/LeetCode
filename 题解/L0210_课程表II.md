---
title: è¯¾ç¨‹è¡¨ II
date: 2024-02-09
---

## é¢˜ç›®æè¿°

**ğŸ”— é¢˜ç›®**ï¼š[è¯¾ç¨‹è¡¨ II](https://leetcode.cn/problems/course-schedule-ii/)  
**ğŸ·ï¸ æ ‡ç­¾**ï¼š`æ·±åº¦ä¼˜å…ˆæœç´¢` `å¹¿åº¦ä¼˜å…ˆæœç´¢` `å›¾` `æ‹“æ‰‘æ’åº`  
**ğŸŸ¡ éš¾åº¦**ï¼š`ä¸­ç­‰`  

ç°åœ¨ä½ æ€»å…±æœ‰ numCourses é—¨è¯¾éœ€è¦é€‰ï¼Œè®°ä¸º 0 åˆ° numCourses - 1ã€‚ç»™ä½ ä¸€ä¸ªæ•°ç»„ prerequisites ï¼Œå…¶ä¸­ prerequisites[i] = [ai, bi] ï¼Œè¡¨ç¤ºåœ¨é€‰ä¿®è¯¾ç¨‹ ai å‰ å¿…é¡» å…ˆé€‰ä¿® bi ã€‚

ä¾‹å¦‚ï¼Œæƒ³è¦å­¦ä¹ è¯¾ç¨‹ 0 ï¼Œä½ éœ€è¦å…ˆå®Œæˆè¯¾ç¨‹ 1 ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªåŒ¹é…æ¥è¡¨ç¤ºï¼š[0,1] ã€‚
è¿”å›ä½ ä¸ºäº†å­¦å®Œæ‰€æœ‰è¯¾ç¨‹æ‰€å®‰æ’çš„å­¦ä¹ é¡ºåºã€‚å¯èƒ½ä¼šæœ‰å¤šä¸ªæ­£ç¡®çš„é¡ºåºï¼Œä½ åªè¦è¿”å› ä»»æ„ä¸€ç§ å°±å¯ä»¥äº†ã€‚å¦‚æœä¸å¯èƒ½å®Œæˆæ‰€æœ‰è¯¾ç¨‹ï¼Œè¿”å› ä¸€ä¸ªç©ºæ•°ç»„ ã€‚

ç¤ºä¾‹ 1ï¼š
```
è¾“å…¥ï¼šnumCourses = 2, prerequisites = [[1,0]]
è¾“å‡ºï¼š[0,1]
è§£é‡Šï¼šæ€»å…±æœ‰ 2 é—¨è¯¾ç¨‹ã€‚è¦å­¦ä¹ è¯¾ç¨‹ 1ï¼Œä½ éœ€è¦å…ˆå®Œæˆè¯¾ç¨‹ 0ã€‚å› æ­¤ï¼Œæ­£ç¡®çš„è¯¾ç¨‹é¡ºåºä¸º [0,1] ã€‚
```

ç¤ºä¾‹ 2ï¼š
```
è¾“å…¥ï¼šnumCourses = 4, prerequisites = [[1,0],[2,0],[3,1],[3,2]]
è¾“å‡ºï¼š[0,2,1,3]
è§£é‡Šï¼šæ€»å…±æœ‰ 4 é—¨è¯¾ç¨‹ã€‚è¦å­¦ä¹ è¯¾ç¨‹ 3ï¼Œä½ åº”è¯¥å…ˆå®Œæˆè¯¾ç¨‹ 1 å’Œè¯¾ç¨‹ 2ã€‚å¹¶ä¸”è¯¾ç¨‹ 1 å’Œè¯¾ç¨‹ 2 éƒ½åº”è¯¥æ’åœ¨è¯¾ç¨‹ 0 ä¹‹åã€‚
å› æ­¤ï¼Œä¸€ä¸ªæ­£ç¡®çš„è¯¾ç¨‹é¡ºåºæ˜¯ [0,1,2,3] ã€‚å¦ä¸€ä¸ªæ­£ç¡®çš„æ’åºæ˜¯ [0,2,1,3] ã€‚
```

ç¤ºä¾‹ 3ï¼š
```
è¾“å…¥ï¼šnumCourses = 1, prerequisites = []
è¾“å‡ºï¼š[0]
```

æç¤ºï¼š
- 1 <= numCourses <= 2000
- 0 <= prerequisites.length <= numCourses * (numCourses - 1)
- prerequisites[i].length == 2
- 0 <= ai, bi < numCourses
- ai != bi
- æ‰€æœ‰[ai, bi] äº’ä¸ç›¸åŒ

---

## è§£é¢˜æ€è·¯

### æ‹“æ‰‘æ’åºï¼ˆBFSï¼‰

#### ğŸ“ æ ¸å¿ƒæ€æƒ³
è¿™é“é¢˜æ˜¯è¯¾ç¨‹è¡¨ I çš„è¿›é˜¶ç‰ˆæœ¬ï¼Œä¸ä»…è¦åˆ¤æ–­æ˜¯å¦å¯ä»¥å®Œæˆæ‰€æœ‰è¯¾ç¨‹ï¼Œè¿˜è¦è¿”å›ä¸€ä¸ªåˆæ³•çš„å­¦ä¹ é¡ºåºã€‚æˆ‘ä»¬åŒæ ·å¯ä»¥ä½¿ç”¨æ‹“æ‰‘æ’åºæ¥è§£å†³ï¼Œä½†éœ€è¦è®°å½•è®¿é—®é¡ºåºã€‚

æ‹“æ‰‘æ’åºçš„åŸºæœ¬æ€è·¯æ˜¯ï¼š
1. ç»Ÿè®¡æ¯ä¸ªèŠ‚ç‚¹çš„å…¥åº¦ï¼ˆæœ‰å¤šå°‘ä¸ªèŠ‚ç‚¹æŒ‡å‘å®ƒï¼‰
2. å°†æ‰€æœ‰å…¥åº¦ä¸º 0 çš„èŠ‚ç‚¹åŠ å…¥é˜Ÿåˆ—ï¼ˆè¿™äº›æ˜¯å¯ä»¥ç›´æ¥å­¦ä¹ çš„è¯¾ç¨‹ï¼‰
3. æ¯æ¬¡ä»é˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°†å…¶åŠ å…¥ç»“æœæ•°ç»„
4. å°†å…¶æ‰€æœ‰ç›¸é‚»èŠ‚ç‚¹çš„å…¥åº¦å‡ 1
5. å¦‚æœæŸä¸ªèŠ‚ç‚¹çš„å…¥åº¦å˜ä¸º 0ï¼Œåˆ™å°†å…¶åŠ å…¥é˜Ÿåˆ—
6. é‡å¤æ­¥éª¤ 3-5ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸ºç©º

#### ğŸ› ï¸ å®ç°æ­¥éª¤
1. æ„å»ºé‚»æ¥è¡¨å’Œå…¥åº¦æ•°ç»„ï¼š
   - ä½¿ç”¨ List<List<Integer>> å­˜å‚¨é‚»æ¥è¡¨
   - ä½¿ç”¨ int[] å­˜å‚¨æ¯ä¸ªèŠ‚ç‚¹çš„å…¥åº¦

2. åˆå§‹åŒ–æ•°æ®ç»“æ„ï¼š
   - éå† prerequisites æ•°ç»„ï¼Œæ„å»ºé‚»æ¥è¡¨
   - åŒæ—¶ç»Ÿè®¡æ¯ä¸ªèŠ‚ç‚¹çš„å…¥åº¦

3. æ‹“æ‰‘æ’åºï¼š
   - å°†æ‰€æœ‰å…¥åº¦ä¸º 0 çš„èŠ‚ç‚¹åŠ å…¥é˜Ÿåˆ—
   - ä½¿ç”¨ BFS éå†å›¾
   - è®°å½•è®¿é—®é¡ºåºåˆ°ç»“æœæ•°ç»„

4. è¿”å›ç»“æœï¼š
   - å¦‚æœè®¿é—®çš„èŠ‚ç‚¹æ•°ç­‰äºæ€»è¯¾ç¨‹æ•°ï¼Œè¿”å›ç»“æœæ•°ç»„
   - å¦åˆ™è¿”å›ç©ºæ•°ç»„

#### ğŸ§© ç¤ºä¾‹åˆ†æ
ä»¥ç¤ºä¾‹ 2 ä¸ºä¾‹ï¼Œåˆ†ææ•´ä¸ªè¿‡ç¨‹ï¼š
```
è¾“å…¥ï¼šnumCourses = 4, prerequisites = [[1,0],[2,0],[3,1],[3,2]]
```

1. åˆå§‹çŠ¶æ€ï¼š
```
è¯¾ç¨‹å…³ç³»å›¾ï¼š
     1
   â†—   â†˜
0         3
   â†˜   â†—
     2

å…¥åº¦æ•°ç»„ï¼š[0, 1, 1, 2]
é‚»æ¥è¡¨ï¼š
0: [1, 2]
1: [3]
2: [3]
3: []
```

2. æ‹“æ‰‘æ’åºè¿‡ç¨‹ï¼š

| æ­¥éª¤ | é˜Ÿåˆ— | å·²è®¿é—®èŠ‚ç‚¹ | å…¥åº¦æ•°ç»„ | è¯´æ˜ |
|-----|------|-----------|---------|------|
| 1 | [0] | [] | [0,1,1,2] | è¯¾ç¨‹ 0 å…¥åº¦ä¸º 0ï¼ŒåŠ å…¥é˜Ÿåˆ— |
| 2 | [1,2] | [0] | [0,0,0,2] | è®¿é—®è¯¾ç¨‹ 0ï¼Œè¯¾ç¨‹ 1,2 å…¥åº¦å‡ 1 |
| 3 | [2,3] | [0,1] | [0,0,0,1] | è®¿é—®è¯¾ç¨‹ 1ï¼Œè¯¾ç¨‹ 3 å…¥åº¦å‡ 1 |
| 4 | [3] | [0,2,1] | [0,0,0,0] | è®¿é—®è¯¾ç¨‹ 2ï¼Œè¯¾ç¨‹ 3 å…¥åº¦å‡ 1 |
| 5 | [] | [0,2,1,3] | [0,0,0,0] | è®¿é—®è¯¾ç¨‹ 3 |

æœ€ç»ˆå¾—åˆ°è¯¾ç¨‹é¡ºåºï¼š[0,2,1,3]

---

## ä»£ç å®ç°

å®Œæ•´çš„å¯è¿è¡Œä»£ç ï¼š[L0210_CourseScheduleII.java](../src/main/java/L0210_CourseScheduleII.java)

```java
public int[] findOrder(int numCourses, int[][] prerequisites) {
    // æ„å»ºé‚»æ¥è¡¨å’Œå…¥åº¦æ•°ç»„
    List<List<Integer>> adjacency = new ArrayList<>();
    int[] inDegrees = new int[numCourses];
    
    // åˆå§‹åŒ–é‚»æ¥è¡¨
    for (int i = 0; i < numCourses; i++) {
        adjacency.add(new ArrayList<>());
    }
    
    // æ„å»ºé‚»æ¥è¡¨å’Œè®¡ç®—å…¥åº¦
    for (int[] prerequisite : prerequisites) {
        int course = prerequisite[0];
        int prerequisiteCourse = prerequisite[1];
        adjacency.get(prerequisiteCourse).add(course);
        inDegrees[course]++;
    }
    
    // å°†æ‰€æœ‰å…¥åº¦ä¸º 0 çš„è¯¾ç¨‹åŠ å…¥é˜Ÿåˆ—
    Queue<Integer> queue = new LinkedList<>();
    for (int i = 0; i < numCourses; i++) {
        if (inDegrees[i] == 0) {
            queue.offer(i);
        }
    }
    
    // è®°å½•è¯¾ç¨‹é¡ºåº
    int[] result = new int[numCourses];
    int count = 0;
    
    // BFS æ‹“æ‰‘æ’åº
    while (!queue.isEmpty()) {
        int course = queue.poll();
        result[count++] = course;
        
        // å°†å½“å‰è¯¾ç¨‹çš„æ‰€æœ‰åç»­è¯¾ç¨‹çš„å…¥åº¦å‡ 1
        for (int nextCourse : adjacency.get(course)) {
            inDegrees[nextCourse]--;
            // å¦‚æœå…¥åº¦å˜ä¸º 0ï¼Œåˆ™åŠ å…¥é˜Ÿåˆ—
            if (inDegrees[nextCourse] == 0) {
                queue.offer(nextCourse);
            }
        }
    }
    
    // å¦‚æœæ— æ³•å®Œæˆæ‰€æœ‰è¯¾ç¨‹ï¼Œè¿”å›ç©ºæ•°ç»„
    return count == numCourses ? result : new int[0];
}
```

---

## å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼šO(V + E)
  - V æ˜¯è¯¾ç¨‹æ•°é‡ï¼ˆé¡¶ç‚¹æ•°ï¼‰
  - E æ˜¯å…ˆä¿®è¯¾ç¨‹çš„è¦æ±‚æ•°é‡ï¼ˆè¾¹æ•°ï¼‰
  - éœ€è¦éå†æ‰€æœ‰çš„é¡¶ç‚¹å’Œè¾¹ä¸€æ¬¡

- **ç©ºé—´å¤æ‚åº¦**ï¼šO(V + E)
  - é‚»æ¥è¡¨éœ€è¦ O(V + E) çš„ç©ºé—´
  - å…¥åº¦æ•°ç»„éœ€è¦ O(V) çš„ç©ºé—´
  - é˜Ÿåˆ—æœ€å¤šéœ€è¦ O(V) çš„ç©ºé—´
  - ç»“æœæ•°ç»„éœ€è¦ O(V) çš„ç©ºé—´

---

## LeetCode é¢˜è§£

æœ¬é¢˜è§£æ˜¯ LeetCode ç³»åˆ—é¢˜è§£çš„ä¸€éƒ¨åˆ†ã€‚è¯¥ç³»åˆ—é¢˜è§£è‡´åŠ›äºå¸®åŠ©ç¨‹åºå‘˜æ›´å¥½åœ°ç†è§£å’ŒæŒæ¡ç®—æ³•æ€ç»´ï¼Œå†…å®¹åŒ…å«è¯¦ç»†çš„è§£é¢˜æ€è·¯åˆ†æã€å›¾æ–‡å¹¶èŒ‚çš„ç¤ºä¾‹è®²è§£å’Œå®Œæ•´çš„ä»£ç å®ç°ã€‚

<img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="GitHub" width="20" style="vertical-align: middle; margin-right: 5px"> [LeetCode æœ€å…¨é¢˜è§£](https://github.com/LjyYano/LeetCode)ï¼šæŒç»­æ›´æ–°ä¸­ï¼Œæ¬¢è¿ Star â­ï¸ å…³æ³¨ï¼Œä¸€èµ·æ¢è®¨ç®—æ³•ä¹‹ç¾ã€‚ 