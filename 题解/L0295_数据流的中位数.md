---
title: æ•°æ®æµçš„ä¸­ä½æ•°
date: 2024-03-27
---

## é¢˜ç›®æè¿°

**ğŸ”— é¢˜ç›®**ï¼š[æ•°æ®æµçš„ä¸­ä½æ•°](https://leetcode.cn/problems/find-median-from-data-stream/)  
**ğŸ·ï¸ æ ‡ç­¾**ï¼š`è®¾è®¡` `åŒå †` `æ•°æ®æµ` `å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰`  
**ğŸ”´ éš¾åº¦**ï¼š`å›°éš¾`  

ä¸­ä½æ•°æ˜¯æœ‰åºæ•´æ•°åˆ—è¡¨ä¸­çš„ä¸­é—´å€¼ã€‚å¦‚æœåˆ—è¡¨çš„å¤§å°æ˜¯å¶æ•°ï¼Œåˆ™æ²¡æœ‰ä¸­é—´å€¼ï¼Œä¸­ä½æ•°æ˜¯ä¸¤ä¸ªä¸­é—´å€¼çš„å¹³å‡å€¼ã€‚

ä¾‹å¦‚ arr = [2,3,4] çš„ä¸­ä½æ•°æ˜¯ 3 ã€‚
ä¾‹å¦‚ arr = [2,3] çš„ä¸­ä½æ•°æ˜¯ (2 + 3) / 2 = 2.5 ã€‚

å®ç° MedianFinder ç±»:
- MedianFinder() åˆå§‹åŒ– MedianFinder å¯¹è±¡ã€‚
- void addNum(int num) ä»æ•°æ®æµä¸­æ·»åŠ ä¸€ä¸ªæ•´æ•° num
- double findMedian() è¿”å›åˆ°ç›®å‰ä¸ºæ­¢æ‰€æœ‰å…ƒç´ çš„ä¸­ä½æ•°ã€‚ä¸å®é™…ç­”æ¡ˆç›¸å·® 10â»âµ ä»¥å†…çš„ç­”æ¡ˆå°†è¢«æ¥å—ã€‚

ç¤ºä¾‹ 1ï¼š
```
è¾“å…¥
["MedianFinder", "addNum", "addNum", "findMedian", "addNum", "findMedian"]
[[], [1], [2], [], [3], []]
è¾“å‡º
[null, null, null, 1.5, null, 2.0]

è§£é‡Š
MedianFinder medianFinder = new MedianFinder();
medianFinder.addNum(1);    // arr = [1]
medianFinder.addNum(2);    // arr = [1, 2]
medianFinder.findMedian(); // è¿”å› 1.5 ((1 + 2) / 2)
medianFinder.addNum(3);    // arr = [1, 2, 3]
medianFinder.findMedian(); // è¿”å› 2.0
```

æç¤º:
- -10âµ <= num <= 10âµ
- åœ¨è°ƒç”¨ findMedian ä¹‹å‰ï¼Œæ•°æ®ç»“æ„ä¸­è‡³å°‘æœ‰ä¸€ä¸ªå…ƒç´ 
- æœ€å¤šè°ƒç”¨ 5 * 10â´ æ¬¡ addNum å’Œ findMedian

---

## è§£é¢˜æ€è·¯
### åŒå †æ³•

#### ğŸ“ æ ¸å¿ƒæ€æƒ³
ä½¿ç”¨ä¸¤ä¸ªå †æ¥ç»´æŠ¤æ•°æ®æµçš„ä¸­ä½æ•°ï¼š
1. å¤§é¡¶å †å­˜å‚¨è¾ƒå°çš„ä¸€åŠæ•°å­—
2. å°é¡¶å †å­˜å‚¨è¾ƒå¤§çš„ä¸€åŠæ•°å­—
3. ä¿æŒä¸¤ä¸ªå †çš„å¤§å°å¹³è¡¡ï¼ˆç›¸ç­‰æˆ–å¤§é¡¶å †æ¯”å°é¡¶å †å¤šä¸€ä¸ªå…ƒç´ ï¼‰

è¿™æ ·è®¾è®¡çš„å¥½å¤„æ˜¯ï¼š
- å¤§é¡¶å †çš„å †é¡¶æ˜¯è¾ƒå°ä¸€åŠæ•°å­—ä¸­çš„æœ€å¤§å€¼
- å°é¡¶å †çš„å †é¡¶æ˜¯è¾ƒå¤§ä¸€åŠæ•°å­—ä¸­çš„æœ€å°å€¼
- ä¸­ä½æ•°è¦ä¹ˆæ˜¯å¤§é¡¶å †çš„å †é¡¶ï¼ˆå¥‡æ•°ä¸ªå…ƒç´ ï¼‰ï¼Œè¦ä¹ˆæ˜¯ä¸¤ä¸ªå †é¡¶çš„å¹³å‡å€¼ï¼ˆå¶æ•°ä¸ªå…ƒç´ ï¼‰

#### ğŸ› ï¸ å®ç°æ­¥éª¤
1. åˆå§‹åŒ–ï¼š
   - åˆ›å»ºä¸€ä¸ªå¤§é¡¶å †å’Œä¸€ä¸ªå°é¡¶å †
   - å¤§é¡¶å †ç”¨äºå­˜å‚¨è¾ƒå°çš„ä¸€åŠæ•°å­—
   - å°é¡¶å †ç”¨äºå­˜å‚¨è¾ƒå¤§çš„ä¸€åŠæ•°å­—

2. æ·»åŠ æ•°å­—ï¼ˆaddNumï¼‰ï¼š
   - å…ˆå°†æ•°å­—åŠ å…¥å¤§é¡¶å †
   - å°†å¤§é¡¶å †çš„æœ€å¤§å€¼ç§»åˆ°å°é¡¶å †
   - å¦‚æœå°é¡¶å †çš„å¤§å°å¤§äºå¤§é¡¶å †ï¼Œå°†å°é¡¶å †çš„æœ€å°å€¼ç§»å›å¤§é¡¶å †

3. æŸ¥æ‰¾ä¸­ä½æ•°ï¼ˆfindMedianï¼‰ï¼š
   - å¦‚æœä¸¤ä¸ªå †å¤§å°ç›¸ç­‰ï¼Œè¿”å›ä¸¤ä¸ªå †é¡¶çš„å¹³å‡å€¼
   - å¦åˆ™è¿”å›å¤§é¡¶å †çš„å †é¡¶ï¼ˆæ­¤æ—¶å¤§é¡¶å †æ¯”å°é¡¶å †å¤šä¸€ä¸ªå…ƒç´ ï¼‰

#### ğŸ§© ç¤ºä¾‹åˆ†æ
ä»¥ç¤ºä¾‹ 1 ä¸ºä¾‹ï¼Œæ¼”ç¤ºæ•´ä¸ªè¿‡ç¨‹ï¼š

1. æ·»åŠ æ•°å­— 1ï¼š
```
å¤§é¡¶å †ï¼š[1]    å°é¡¶å †ï¼š[]
ä¸­ä½æ•° = 1.0
```

2. æ·»åŠ æ•°å­— 2ï¼š
```
åˆå§‹çŠ¶æ€ï¼šå¤§é¡¶å †ï¼š[1]    å°é¡¶å †ï¼š[]
æ­¥éª¤ 1ï¼šå¤§é¡¶å †ï¼š[1,2]    å°é¡¶å †ï¼š[]
æ­¥éª¤ 2ï¼šå¤§é¡¶å †ï¼š[1]      å°é¡¶å †ï¼š[2]
ä¸­ä½æ•° = (1 + 2) / 2 = 1.5
```

3. æ·»åŠ æ•°å­— 3ï¼š
```
åˆå§‹çŠ¶æ€ï¼šå¤§é¡¶å †ï¼š[1]    å°é¡¶å †ï¼š[2]
æ­¥éª¤ 1ï¼šå¤§é¡¶å †ï¼š[1,3]    å°é¡¶å †ï¼š[2]
æ­¥éª¤ 2ï¼šå¤§é¡¶å †ï¼š[1]      å°é¡¶å †ï¼š[2,3]
æ­¥éª¤ 3ï¼šå¤§é¡¶å †ï¼š[2]      å°é¡¶å †ï¼š[3]
ä¸­ä½æ•° = 2.0
```

---

## ä»£ç å®ç°

å®Œæ•´çš„å¯è¿è¡Œä»£ç ï¼š[L0295_FindMedianFromDataStream.java](../src/main/java/L0295_FindMedianFromDataStream.java)

```java
public class L0295_FindMedianFromDataStream {
    
    // å¤§é¡¶å †ï¼Œå­˜å‚¨è¾ƒå°çš„ä¸€åŠæ•°å­—
    private final PriorityQueue<Integer> maxHeap;
    // å°é¡¶å †ï¼Œå­˜å‚¨è¾ƒå¤§çš„ä¸€åŠæ•°å­—
    private final PriorityQueue<Integer> minHeap;
    
    public L0295_FindMedianFromDataStream() {
        // åˆå§‹åŒ–ä¸¤ä¸ªå †
        maxHeap = new PriorityQueue<>((a, b) -> b - a);  // å¤§é¡¶å †
        minHeap = new PriorityQueue<>();  // å°é¡¶å †
    }
    
    public void addNum(int num) {
        // å…ˆå°†æ•°å­—åŠ å…¥å¤§é¡¶å †
        maxHeap.offer(num);
        // å°†å¤§é¡¶å †çš„æœ€å¤§å€¼ç§»åˆ°å°é¡¶å †
        minHeap.offer(maxHeap.poll());
        
        // ä¿æŒä¸¤ä¸ªå †çš„å¤§å°å¹³è¡¡
        // å¦‚æœå°é¡¶å †çš„å¤§å°å¤§äºå¤§é¡¶å †ï¼Œå°†å°é¡¶å †çš„æœ€å°å€¼ç§»åˆ°å¤§é¡¶å †
        if (minHeap.size() > maxHeap.size()) {
            maxHeap.offer(minHeap.poll());
        }
    }
    
    public double findMedian() {
        // å¦‚æœä¸¤ä¸ªå †å¤§å°ç›¸ç­‰ï¼Œå–ä¸¤ä¸ªå †é¡¶çš„å¹³å‡å€¼
        if (maxHeap.size() == minHeap.size()) {
            return (maxHeap.peek() + minHeap.peek()) / 2.0;
        }
        // å¦åˆ™å¤§é¡¶å †çš„å¤§å°æ¯”å°é¡¶å †å¤§1ï¼Œç›´æ¥è¿”å›å¤§é¡¶å †çš„å †é¡¶
        return maxHeap.peek();
    }
}
```

---

## å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š
  - addNumï¼šO(log n)ï¼Œä¸»è¦æ˜¯å †çš„æ’å…¥å’Œåˆ é™¤æ“ä½œ
  - findMedianï¼šO(1)ï¼Œç›´æ¥è¿”å›å †é¡¶å…ƒç´ æˆ–è®¡ç®—å¹³å‡å€¼
- **ç©ºé—´å¤æ‚åº¦**ï¼šO(n)ï¼Œéœ€è¦å­˜å‚¨æ‰€æœ‰æ•°å­—

---

## LeetCode é¢˜è§£

æœ¬é¢˜è§£æ˜¯ LeetCode ç³»åˆ—é¢˜è§£çš„ä¸€éƒ¨åˆ†ã€‚è¯¥ç³»åˆ—é¢˜è§£è‡´åŠ›äºå¸®åŠ©ç¨‹åºå‘˜æ›´å¥½åœ°ç†è§£å’ŒæŒæ¡ç®—æ³•æ€ç»´ï¼Œå†…å®¹åŒ…å«è¯¦ç»†çš„è§£é¢˜æ€è·¯åˆ†æã€å›¾æ–‡å¹¶èŒ‚çš„ç¤ºä¾‹è®²è§£å’Œå®Œæ•´çš„ä»£ç å®ç°ã€‚

<img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="GitHub" width="20" style="vertical-align: middle; margin-right: 5px"> [LeetCode æœ€å…¨é¢˜è§£](https://github.com/LjyYano/LeetCode)ï¼šæŒç»­æ›´æ–°ä¸­ï¼Œæ¬¢è¿ Star â­ï¸ å…³æ³¨ï¼Œä¸€èµ·æ¢è®¨ç®—æ³•ä¹‹ç¾ã€‚ 