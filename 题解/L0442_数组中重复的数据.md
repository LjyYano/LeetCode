---
title: 数组中重复的数据
date: 2024-03-27
---

## 题目描述

**🔗 题目**：[数组中重复的数据](https://leetcode.cn/problems/find-all-duplicates-in-an-array/)  
**🏷️ 标签**：`数组` `哈希表`  
**🟡 难度**：`中等`  

给你一个长度为 n 的整数数组 nums ，其中 nums 的所有整数都在范围 [1, n] 内，且每个整数出现 一次 或 两次 。请你找出所有出现 两次 的整数，并以数组形式返回。

你必须设计并实现一个时间复杂度为 O(n) 且仅使用常量额外空间的算法解决此问题。

示例 1：
```
输入：nums = [4,3,2,7,8,2,3,1]
输出：[2,3]
```

示例 2：
```
输入：nums = [1,1,2]
输出：[1]
```

示例 3：
```
输入：nums = [1]
输出：[]
```

---

## 解题思路

### 原地修改数组

#### 📝 核心思想
利用数组元素的正负号来标记元素是否出现过。由于数组中的数字范围是 [1, n]，我们可以使用数组本身来标记每个数字的出现情况，而不需要额外的空间。当遇到一个数字时，将其对应位置的数字取相反数，如果之后再次遇到这个数字，发现对应位置的数字已经是负数，说明这个数字出现了两次。

#### 🛠️ 实现步骤
1. 遍历数组中的每个数字 num
2. 获取 num 的绝对值（因为可能已经被标记为负数）
3. 检查 nums[num-1] 的符号：
   - 如果是正数，将其变为负数
   - 如果是负数，说明 num 之前出现过，将 num 加入结果列表
4. 最后返回结果列表

#### 🧩 示例分析
以 nums = [4,3,2,7,8,2,3,1] 为例：

| 步骤 | 当前数字 | 数组状态 | 操作 | 结果列表 |
|-----|---------|---------|------|---------|
| 初始 | - | [4,3,2,7,8,2,3,1] | - | [] |
| 1 | 4 | [4,3,2,-7,8,2,3,1] | 标记 nums[3] | [] |
| 2 | 3 | [4,3,-2,-7,8,2,3,1] | 标记 nums[2] | [] |
| 3 | 2 | [4,-3,-2,-7,8,2,3,1] | 标记 nums[1] | [] |
| 4 | 7 | [4,-3,-2,-7,8,2,-3,1] | 标记 nums[6] | [] |
| 5 | 8 | [4,-3,-2,-7,8,2,-3,-1] | 标记 nums[7] | [] |
| 6 | 2 | [4,-3,-2,-7,8,2,-3,-1] | nums[1] 已负 | [2] |
| 7 | 3 | [4,-3,-2,-7,8,2,-3,-1] | nums[2] 已负 | [2,3] |
| 8 | 1 | [-4,-3,-2,-7,8,2,-3,-1] | 标记 nums[0] | [2,3] |

---

## 代码实现

完整的可运行代码：[L0442_FindAllDuplicatesInAnArray.java](../src/main/java/L0442_FindAllDuplicatesInAnArray.java)

```java
public List<Integer> findDuplicates(int[] nums) {
    List<Integer> result = new ArrayList<>();
    
    // 使用数组元素的正负号来标记是否出现过
    // 因为数组中的数字范围是 [1, n]，所以可以用数组本身来标记
    for (int i = 0; i < nums.length; i++) {
        // 获取当前数字的绝对值（因为可能被之前的操作变成负数）
        int num = Math.abs(nums[i]);
        // nums[num - 1] 为负数说明 num 之前出现过
        if (nums[num - 1] > 0) {
            nums[num - 1] = -nums[num - 1];
        } else {
            result.add(num);
        }
    }
    
    return result;
}
```

---

## 复杂度分析

- **时间复杂度**：O(n)，其中 n 是数组的长度。我们只需要遍历一次数组。
- **空间复杂度**：O(1)，除了存储结果的列表外，我们只使用了常量额外空间。

---

## LeetCode 题解

本题解是 LeetCode 系列题解的一部分。该系列题解致力于帮助程序员更好地理解和掌握算法思维，内容包含详细的解题思路分析、图文并茂的示例讲解和完整的代码实现。

<img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="GitHub" width="20" style="vertical-align: middle; margin-right: 5px"> [LeetCode 最全题解](https://github.com/LjyYano/LeetCode)：持续更新中，欢迎 Star ⭐️ 关注，一起探讨算法之美。 