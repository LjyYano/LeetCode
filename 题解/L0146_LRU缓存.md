---
title: LRU ç¼“å­˜
date: 2025-02-09
---

## é¢˜ç›®æè¿°

**ğŸ”— é¢˜ç›®**ï¼š[LRU ç¼“å­˜](https://leetcode.cn/problems/lru-cache/)  
**ğŸ·ï¸ æ ‡ç­¾**ï¼š`è®¾è®¡` `å“ˆå¸Œè¡¨` `é“¾è¡¨` `åŒå‘é“¾è¡¨`  
**ğŸŸ¡ éš¾åº¦**ï¼š`ä¸­ç­‰`  

è¯·ä½ è®¾è®¡å¹¶å®ç°ä¸€ä¸ªæ»¡è¶³ LRU (æœ€è¿‘æœ€å°‘ä½¿ç”¨) ç¼“å­˜ çº¦æŸçš„æ•°æ®ç»“æ„ã€‚

å®ç° LRUCache ç±»ï¼š
- LRUCache(int capacity) ä»¥ æ­£æ•´æ•° ä½œä¸ºå®¹é‡ capacity åˆå§‹åŒ– LRU ç¼“å­˜
- int get(int key) å¦‚æœå…³é”®å­— key å­˜åœ¨äºç¼“å­˜ä¸­ï¼Œåˆ™è¿”å›å…³é”®å­—çš„å€¼ï¼Œå¦åˆ™è¿”å› -1 ã€‚
- void put(int key, int value) å¦‚æœå…³é”®å­— key å·²ç»å­˜åœ¨ï¼Œåˆ™å˜æ›´å…¶æ•°æ®å€¼ value ï¼›å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™å‘ç¼“å­˜ä¸­æ’å…¥è¯¥ç»„ key-value ã€‚å¦‚æœæ’å…¥æ“ä½œå¯¼è‡´å…³é”®å­—æ•°é‡è¶…è¿‡ capacity ï¼Œåˆ™åº”è¯¥ é€å‡º æœ€ä¹…æœªä½¿ç”¨çš„å…³é”®å­—ã€‚

å‡½æ•° get å’Œ put å¿…é¡»ä»¥ O(1) çš„å¹³å‡æ—¶é—´å¤æ‚åº¦è¿è¡Œã€‚

**ç¤ºä¾‹ï¼š**
```
è¾“å…¥
["LRUCache", "put", "put", "get", "put", "get", "put", "get", "get", "get"]
[[2], [1, 1], [2, 2], [1], [3, 3], [2], [4, 4], [1], [3], [4]]
è¾“å‡º
[null, null, null, 1, null, -1, null, -1, 3, 4]

è§£é‡Š
LRUCache lRUCache = new LRUCache(2);
lRUCache.put(1, 1); // ç¼“å­˜æ˜¯ {1=1}
lRUCache.put(2, 2); // ç¼“å­˜æ˜¯ {1=1, 2=2}
lRUCache.get(1);    // è¿”å› 1
lRUCache.put(3, 3); // è¯¥æ“ä½œä¼šä½¿å¾—å…³é”®å­— 2 ä½œåºŸï¼Œç¼“å­˜æ˜¯ {1=1, 3=3}
lRUCache.get(2);    // è¿”å› -1 (æœªæ‰¾åˆ°)
lRUCache.put(4, 4); // è¯¥æ“ä½œä¼šä½¿å¾—å…³é”®å­— 1 ä½œåºŸï¼Œç¼“å­˜æ˜¯ {4=4, 3=3}
lRUCache.get(1);    // è¿”å› -1 (æœªæ‰¾åˆ°)
lRUCache.get(3);    // è¿”å› 3
lRUCache.get(4);    // è¿”å› 4
```

**æç¤ºï¼š**
- 1 <= capacity <= 3000
- 0 <= key <= 10000
- 0 <= value <= 10âµ
- æœ€å¤šè°ƒç”¨ 2 * 10âµ æ¬¡ get å’Œ put æ“ä½œ

---

## è§£é¢˜æ€è·¯

### å“ˆå¸Œè¡¨ + åŒå‘é“¾è¡¨

#### ğŸ“ æ ¸å¿ƒæ€æƒ³

LRUï¼ˆLeast Recently Usedï¼‰ç¼“å­˜æ˜¯ä¸€ç§å¸¸ç”¨çš„ç¼“å­˜æ·˜æ±°ç­–ç•¥ï¼Œå®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šå½“ç¼“å­˜æ»¡æ—¶ï¼Œä¼˜å…ˆæ·˜æ±°æœ€ä¹…æœªä½¿ç”¨çš„æ•°æ®ã€‚ä¸ºäº†å®ç° O(1) æ—¶é—´å¤æ‚åº¦çš„æ“ä½œï¼Œæˆ‘ä»¬éœ€è¦ï¼š

1. å¿«é€ŸæŸ¥æ‰¾ï¼šä½¿ç”¨å“ˆå¸Œè¡¨å­˜å‚¨ key åˆ°èŠ‚ç‚¹çš„æ˜ å°„ï¼Œå®ç° O(1) çš„æŸ¥æ‰¾
2. å¿«é€Ÿæ’å…¥å’Œåˆ é™¤ï¼šä½¿ç”¨åŒå‘é“¾è¡¨ç»´æŠ¤æ•°æ®çš„è®¿é—®é¡ºåºï¼Œå®ç° O(1) çš„æ’å…¥å’Œåˆ é™¤
3. ç»´æŠ¤è®¿é—®é¡ºåºï¼šæœ€è¿‘è®¿é—®çš„èŠ‚ç‚¹æ”¾åœ¨é“¾è¡¨å¤´éƒ¨ï¼Œæœ€ä¹…æœªè®¿é—®çš„èŠ‚ç‚¹åœ¨é“¾è¡¨å°¾éƒ¨

#### ğŸ› ï¸ å®ç°æ­¥éª¤

1. è®¾è®¡æ•°æ®ç»“æ„ï¼š
   - åŒå‘é“¾è¡¨èŠ‚ç‚¹ï¼ˆNodeï¼‰ï¼šå­˜å‚¨ keyã€value å’Œå‰åæŒ‡é’ˆ
   - å“ˆå¸Œè¡¨ï¼šå­˜å‚¨ key åˆ°èŠ‚ç‚¹çš„æ˜ å°„
   - è™šæ‹Ÿå¤´å°¾èŠ‚ç‚¹ï¼šç®€åŒ–è¾¹ç•Œæƒ…å†µçš„å¤„ç†

2. å®ç°åŸºæœ¬æ“ä½œï¼š
   - addToHeadï¼šå°†èŠ‚ç‚¹æ·»åŠ åˆ°é“¾è¡¨å¤´éƒ¨
   - removeNodeï¼šä»é“¾è¡¨ä¸­åˆ é™¤èŠ‚ç‚¹
   - moveToHeadï¼šå°†èŠ‚ç‚¹ç§»åŠ¨åˆ°å¤´éƒ¨
   - removeTailï¼šåˆ é™¤å°¾éƒ¨èŠ‚ç‚¹

3. å®ç°ç¼“å­˜æ“ä½œï¼š
   - getï¼šæŸ¥æ‰¾èŠ‚ç‚¹å¹¶ç§»åŠ¨åˆ°å¤´éƒ¨
   - putï¼šæ›´æ–°æˆ–æ’å…¥èŠ‚ç‚¹ï¼Œå¿…è¦æ—¶åˆ é™¤å°¾éƒ¨èŠ‚ç‚¹

#### ğŸ§© ç¤ºä¾‹åˆ†æ

ä»¥ç¤ºä¾‹è¾“å…¥ä¸ºä¾‹ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ç¼“å­˜çš„å˜åŒ–è¿‡ç¨‹ï¼š

1. åˆå§‹åŒ–å®¹é‡ä¸º 2 çš„ç¼“å­˜ï¼š
```
head <-> tail
```

2. put(1, 1)ï¼š
```
head <-> [1,1] <-> tail
```

3. put(2, 2)ï¼š
```
head <-> [2,2] <-> [1,1] <-> tail
```

4. get(1)ï¼šè®¿é—® 1ï¼Œå°†å…¶ç§»åŠ¨åˆ°å¤´éƒ¨
```
head <-> [1,1] <-> [2,2] <-> tail
```

5. put(3, 3)ï¼šç¼“å­˜å·²æ»¡ï¼Œåˆ é™¤å°¾éƒ¨çš„ 2ï¼Œæ’å…¥ 3
```
head <-> [3,3] <-> [1,1] <-> tail
```

6. get(2)ï¼šæœªæ‰¾åˆ°ï¼Œè¿”å› -1
```
head <-> [3,3] <-> [1,1] <-> tail
```

7. put(4, 4)ï¼šç¼“å­˜å·²æ»¡ï¼Œåˆ é™¤å°¾éƒ¨çš„ 1ï¼Œæ’å…¥ 4
```
head <-> [4,4] <-> [3,3] <-> tail
```

---

## ä»£ç å®ç°

å®Œæ•´çš„å¯è¿è¡Œä»£ç ï¼š[L0146_LRUCache.java](../src/main/java/L0146_LRUCache.java)

```java
public class L0146_LRUCache {
    
    // åŒå‘é“¾è¡¨èŠ‚ç‚¹ç±»
    private class Node {
        int key;
        int value;
        Node prev;
        Node next;
        
        Node() {}
        
        Node(int key, int value) {
            this.key = key;
            this.value = value;
        }
    }
    
    private final int capacity;
    private final Map<Integer, Node> cache;
    private final Node head;
    private final Node tail;
    
    public L0146_LRUCache(int capacity) {
        this.capacity = capacity;
        this.cache = new HashMap<>();
        this.head = new Node();
        this.tail = new Node();
        head.next = tail;
        tail.prev = head;
    }
    
    public int get(int key) {
        Node node = cache.get(key);
        if (node == null) {
            return -1;
        }
        moveToHead(node);
        return node.value;
    }
    
    public void put(int key, int value) {
        Node node = cache.get(key);
        if (node != null) {
            node.value = value;
            moveToHead(node);
        } else {
            Node newNode = new Node(key, value);
            cache.put(key, newNode);
            addToHead(newNode);
            if (cache.size() > capacity) {
                Node tail = removeTail();
                cache.remove(tail.key);
            }
        }
    }
}
```

---

## å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼šO(1)
  - get æ“ä½œï¼š
    - å“ˆå¸Œè¡¨æŸ¥æ‰¾ï¼šO(1)
    - ç§»åŠ¨èŠ‚ç‚¹åˆ°å¤´éƒ¨ï¼šO(1)
  - put æ“ä½œï¼š
    - å“ˆå¸Œè¡¨æŸ¥æ‰¾/æ’å…¥ï¼šO(1)
    - é“¾è¡¨æ“ä½œï¼ˆæ·»åŠ /åˆ é™¤/ç§»åŠ¨ï¼‰ï¼šO(1)

- **ç©ºé—´å¤æ‚åº¦**ï¼šO(capacity)
  - å“ˆå¸Œè¡¨å­˜å‚¨æœ€å¤š capacity ä¸ªé”®å€¼å¯¹
  - åŒå‘é“¾è¡¨å­˜å‚¨æœ€å¤š capacity ä¸ªèŠ‚ç‚¹
  - ä¸¤ä¸ªé¢å¤–çš„å“¨å…µèŠ‚ç‚¹ï¼ˆå¤´å°¾èŠ‚ç‚¹ï¼‰

---

## LeetCode é¢˜è§£

æœ¬é¢˜è§£æ˜¯ LeetCode ç³»åˆ—é¢˜è§£çš„ä¸€éƒ¨åˆ†ã€‚è¯¥ç³»åˆ—é¢˜è§£è‡´åŠ›äºå¸®åŠ©ç¨‹åºå‘˜æ›´å¥½åœ°ç†è§£å’ŒæŒæ¡ç®—æ³•æ€ç»´ï¼Œå†…å®¹åŒ…å«è¯¦ç»†çš„è§£é¢˜æ€è·¯åˆ†æã€å›¾æ–‡å¹¶èŒ‚çš„ç¤ºä¾‹è®²è§£å’Œå®Œæ•´çš„ä»£ç å®ç°ã€‚

<img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="GitHub" width="20" style="vertical-align: middle; margin-right: 5px"> [LeetCode æœ€å…¨é¢˜è§£](https://github.com/LjyYano/LeetCode)ï¼šæŒç»­æ›´æ–°ä¸­ï¼Œæ¬¢è¿ Star â­ï¸ å…³æ³¨ï¼Œä¸€èµ·æ¢è®¨ç®—æ³•ä¹‹ç¾ã€‚ 